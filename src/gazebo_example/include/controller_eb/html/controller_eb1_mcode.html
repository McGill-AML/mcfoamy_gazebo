<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T4U3">u1</span>,<span class="var type1" id="S3T4U4">u2</span>,<span class="var type1" id="S4T4U5">u3</span>,<span class="var type1" id="S5T4U6">u4</span>] = controller_eb(<span class="var type1" id="S6T2U9">C_ba</span>,<span class="var type1" id="S7T1U10">r_a</span>,<span class="var type1" id="S8T1U11">v_b</span>,<span class="var type1" id="S9T1U12">omega_ba_b</span>,<span class="var type1" id="S10T2U13">C_ra</span>,<span class="var type1" id="S11T1U14">r_ref_a</span>,<span class="var type1" id="S12T1U15">v_ref_r</span>,<span class="var type1" id="S13T1U16">omega_ra_r</span>,<span class="var type1" id="S14T4U17">dt</span>,<span class="var type1" id="S15T4U18">maneuver_switch</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line">    <span class="mxinfo" id="T4:U15"><span class="mxinfo" id="T4:U16"><span class="var type1" id="S16T3U22">parameters</span>.ro</span> = <span class="mxinfo" id="T4:U18">1.225</span></span>; <span class="comment">%Air Density (kg/m^3)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo" id="T4:U19"><span class="mxinfo" id="T4:U20"><span class="var type1" id="S16T3U28">parameters</span>.A_prop</span> = <span class="mxinfo" id="T4:U22">.0507</span></span>; <span class="comment">%Propeller Disk Area (m^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    <span class="mxinfo" id="T4:U23"><span class="mxinfo" id="T4:U24"><span class="var type1" id="S16T3U34">parameters</span>.m</span> = <span class="mxinfo" id="T4:U26">.45</span></span>; <span class="comment">%Mass (kg)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo" id="T4:U27"><span class="mxinfo" id="T4:U28"><span class="var type1" id="S16T3U40">parameters</span>.Ix</span> = <span class="mxinfo" id="T4:U30">0.003922</span></span>; <span class="comment">%Moment of Inertia about x (kg m^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T4:U31"><span class="mxinfo" id="T4:U32"><span class="var type1" id="S16T3U46">parameters</span>.Iy</span> = <span class="mxinfo" id="T4:U34">0.015940</span></span>; <span class="comment">%Moment of Inertia about y (kg m^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T4:U35"><span class="mxinfo" id="T4:U36"><span class="var type1" id="S16T3U52">parameters</span>.Iz</span> = <span class="mxinfo" id="T4:U38">0.01934</span></span>; <span class="comment">%Moment of Inertia about z (kg m^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T4:U39"><span class="mxinfo" id="T4:U40"><span class="var type1" id="S16T3U58">parameters</span>.S</span> = <span class="mxinfo" id="T4:U42">0.14274</span></span>; <span class="comment">%Wing Area (m^2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T4:U43"><span class="mxinfo" id="T4:U44"><span class="var type1" id="S16T3U64">parameters</span>.b</span> = <span class="mxinfo" id="T4:U46">0.864</span></span>; <span class="comment">%Wing Span (m)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T4:U47"><span class="mxinfo" id="T4:U48"><span class="var type1" id="S16T3U70">parameters</span>.cbar</span> = <span class="mxinfo" id="T4:U50">0.21</span></span>; <span class="comment">%Mean Aerodynamic Chord (m)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo" id="T4:U51"><span class="mxinfo" id="T4:U52"><span class="var type1" id="S16T3U76">parameters</span>.Cl_delta_a</span> = <span class="mxinfo" id="T4:U54">-<span class="mxinfo" id="T4:U55">0.0006777</span></span></span>; <span class="comment">%Aileron Control Derivative Coefficient (/deg)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo" id="T4:U56"><span class="mxinfo" id="T4:U57"><span class="var type1" id="S16T3U83">parameters</span>.Cm_delta_e</span> = <span class="mxinfo" id="T4:U59">-<span class="mxinfo" id="T4:U60">0.0117747</span></span></span>; <span class="comment">%Elevator Control Derivative Coefficient (/deg)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo" id="T4:U61"><span class="mxinfo" id="T4:U62"><span class="var type1" id="S16T3U90">parameters</span>.Cn_delta_r</span> = <span class="mxinfo" id="T4:U64">-<span class="mxinfo" id="T4:U65">0.0035663</span></span></span>; <span class="comment">%Rudder Control Derivative Coefficient (/deg)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo" id="T4:U66"><span class="mxinfo" id="T4:U67"><span class="var type1" id="S16T3U97">parameters</span>.delta_a_max</span> = <span class="mxinfo" id="T4:U69">52</span></span>; <span class="comment">%degrees</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo" id="T4:U70"><span class="mxinfo" id="T4:U71"><span class="var type1" id="S16T3U103">parameters</span>.delta_e_max</span> = <span class="mxinfo" id="T4:U73">59</span></span>; <span class="comment">%degrees</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo" id="T4:U74"><span class="mxinfo" id="T4:U75"><span class="var type1" id="S16T3U109">parameters</span>.delta_r_max</span> = <span class="mxinfo" id="T4:U77">49</span></span>; <span class="comment">%degrees</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo" id="T4:U78"><span class="mxinfo" id="T4:U79"><span class="var type1" id="S16T3U115">parameters</span>.omega_t_min</span> = <span class="mxinfo" id="T4:U81">1716</span></span>; <span class="comment">%RPM</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo" id="T4:U82"><span class="mxinfo" id="T4:U83"><span class="var type1" id="S16T3U121">parameters</span>.omega_t_max</span> = <span class="mxinfo" id="T4:U85">6710</span></span>; <span class="comment">%RPM</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo" id="T1:U86"><span class="mxinfo" id="T1:U87"><span class="var type1" id="S16T3U127">parameters</span>.Fhat</span> = <span class="mxinfo" id="T1:U89">[<span class="mxinfo" id="T4:U90">1</span>;<span class="mxinfo" id="T4:U91">0</span>;<span class="mxinfo" id="T4:U92">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo" id="T4:U93"><span class="mxinfo" id="T4:U94"><span class="var type1" id="S16T3U139">parameters</span>.Faero2</span> = <span class="mxinfo" id="T4:U96">-<span class="mxinfo" id="T4:U97">.0157</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo" id="T4:U98"><span class="mxinfo" id="T4:U99"><span class="var type1" id="S16T3U146">parameters</span>.Faero1</span> =  <span class="mxinfo" id="T4:U101">.0524</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo" id="T4:U102"><span class="mxinfo" id="T4:U103"><span class="var type1" id="S16T3U152">parameters</span>.Faero0</span> = <span class="mxinfo" id="T4:U105">-<span class="mxinfo" id="T4:U106">.5583</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo" id="T4:U107"><span class="mxinfo" id="T4:U108"><span class="var type1" id="S17T5U159">gains</span>.Kpp</span> = <span class="mxinfo" id="T4:U110">.08</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T4:U111"><span class="mxinfo" id="T4:U112"><span class="var type1" id="S17T5U165">gains</span>.Kpd</span> = <span class="mxinfo" id="T4:U114">.1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo" id="T4:U115"><span class="mxinfo" id="T4:U116"><span class="var type1" id="S17T5U171">gains</span>.Kv</span> = <span class="mxinfo" id="T4:U118">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo" id="T4:U119"><span class="mxinfo" id="T4:U120"><span class="var type1" id="S17T5U177">gains</span>.Khp</span> = <span class="mxinfo" id="T4:U122">5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo" id="T4:U123"><span class="mxinfo" id="T4:U124"><span class="var type1" id="S17T5U183">gains</span>.Khi</span> = <span class="mxinfo" id="T4:U126">.5</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T4:U127"><span class="mxinfo" id="T4:U128"><span class="var type1" id="S17T5U189">gains</span>.Kap</span> = <span class="mxinfo" id="T4:U130">160</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo" id="T4:U131"><span class="mxinfo" id="T4:U132"><span class="var type1" id="S17T5U195">gains</span>.Kad</span> = <span class="mxinfo" id="T4:U134">8</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo" id="T4:U135"><span class="mxinfo" id="T4:U136"><span class="var type1" id="S17T5U201">gains</span>.K_aero</span> = <span class="mxinfo" id="T4:U138">2</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"> <span class="mxinfo" id="T2:U139"><span class="var type1" id="S18T2U206">C_da</span> = <span class="mxinfo" id="T2:U141"><span class="fcn" id="F55N7:B208">position_controller</span>(<span class="var type1" id="S7T1U209">r_a</span>,<span class="var type1" id="S11T1U210">r_ref_a</span>,<span class="var type1" id="S8T1U211">v_b</span>,<span class="var type1" id="S12T1U212">v_ref_r</span>,<span class="var type1" id="S10T2U213">C_ra</span>,<span class="var type1" id="S6T2U214">C_ba</span>,<span class="var type1" id="S16T3U215">parameters</span>,<span class="var type1" id="S17T5U216">gains</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"> <span class="mxinfo" id="T1:U150"><span class="var type1" id="S20T1U219">M_b</span> = <span class="mxinfo" id="T1:U152"><span class="fcn" id="F78N2:B221">attitude_controller</span>(<span class="var type1" id="S6T2U222">C_ba</span>, <span class="var type1" id="S10T2U223">C_ra</span>, <span class="var type1" id="S18T2U224">C_da</span>, <span class="var type1" id="S13T1U225">omega_ra_r</span>, <span class="var type1" id="S9T1U226">omega_ba_b</span>, <span class="var type1" id="S16T3U227">parameters</span>,<span class="var type1" id="S17T5U228">gains</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"> <span class="mxinfo" id="T4:U160"><span class="var type1" id="S22T4U231">F</span> = <span class="mxinfo" id="T4:U162"><span class="fcn" id="F117N4:B233">force_controller</span>(<span class="var type1" id="S7T1U234">r_a</span>, <span class="var type1" id="S11T1U235">r_ref_a</span>, <span class="var type1" id="S8T1U236">v_b</span>, <span class="var type1" id="S12T1U237">v_ref_r</span>, <span class="var type1" id="S6T2U238">C_ba</span>, <span class="var type1" id="S10T2U239">C_ra</span>,<span class="var type1" id="S14T4U240">dt</span>,<span class="var type1" id="S15T4U241">maneuver_switch</span>,<span class="var type1" id="S16T3U242">parameters</span>,<span class="var type1" id="S17T5U243">gains</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"> <span class="mxinfo" id="T19:U173"><span class="var type1" id="S24T19U246">u</span> = <span class="mxinfo" id="T19:U175"><span class="fcn" id="F129N6:B248">mixer</span>(<span class="var type1" id="S20T1U249">M_b</span>, <span class="var type1" id="S22T4U250">F</span>, <span class="var type1" id="S8T1U251">v_b</span>, <span class="var type1" id="S16T3U252">parameters</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"> <span class="mxinfo" id="T4:U180"><span class="var type1" id="S2T4U255">u1</span>=<span class="mxinfo" id="T4:U182"><span class="var type1" id="S24T19U257">u</span>(<span class="mxinfo" id="T4:U184">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line"> <span class="mxinfo" id="T4:U185"><span class="var type1" id="S3T4U261">u2</span>=<span class="mxinfo" id="T4:U187"><span class="var type1" id="S24T19U263">u</span>(<span class="mxinfo" id="T4:U189">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line"> <span class="mxinfo" id="T4:U190"><span class="var type1" id="S4T4U267">u3</span>=<span class="mxinfo" id="T4:U192"><span class="var type1" id="S24T19U269">u</span>(<span class="mxinfo" id="T4:U194">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line"> <span class="mxinfo" id="T4:U195"><span class="var type1" id="S5T4U273">u4</span>=<span class="mxinfo" id="T4:U197"><span class="var type1" id="S24T19U275">u</span>(<span class="mxinfo" id="T4:U199">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line"></span></span>
</pre>
