<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="100,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% Slightly different from the original McFoamy_Airfoil_Simplified</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Should only be used for MATLAB Code to get MEX file.</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,4" id="srcline4">  4</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">CN</span>,<span class="var type1" id="S3T1U4">CL</span>,<span class="var type1" id="S4T1U5">CD</span>,<span class="var type1" id="S5T1U6">CM</span>,<span class="var type0" id="S6T0U7">Reg</span>] = McFoamy_Airfoil_Simplified(<span class="var type1" id="S7T1U10">i</span>,<span class="var type1" id="S8T1U11">alp</span>,<span class="var type1" id="S9T1U12">cf</span>,<span class="var type1" id="S10T1U13">c</span>,<span class="var type1" id="S11T1U14">def</span>,<span class="var type1" id="S12T1U15">AR</span>,<span class="var type1" id="S13T1U16">Cd0</span>,<span class="var type1" id="S14T1U17">Cd90</span>,<span class="var type1" id="S15T1U18">alp0</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="100,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo" id="T1:U14"><span class="var type1" id="S16T1U21">k_CN</span> = <span class="mxinfo" id="T1:U16">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%----------------- STALL ANGLES AND HIGH AOA ANGLES -----------------%</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% AR_pre = [0.5,0.75,1,1.25,1.5,1.75,2, 3,4,6];</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% alpStall_pre = [44,37,34,22,20,18,18, 18,17,17]*pi/180;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% alpLim_pre = [35,33,28,20,15,14,13, 13,13,13]*pi/180; % By Torres    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo" id="T31:U17"><span class="var type1" id="S17T31U25">AR_pre</span> = <span class="mxinfo" id="T31:U19">[0.1666,0.333,0.4,0.5,1,1.25, 2, 3, 4, 6]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%alpLim_pre = [32,36,34,38,32,21,16,11,10,8]*pi/180; % Alp_Limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T31:U20"><span class="var type1" id="S18T31U40">LowAlpEnd_pre</span> = <span class="mxinfo" id="T31:U22">[32,36,34,38,32,21,16,11,10,8]*pi/180</span></span>; <span class="comment">% Alp_Limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo" id="T31:U23"><span class="var type1" id="S20T31U60">HighAlpStart_pre</span> = <span class="mxinfo" id="T31:U25">[40,60,55,56,40, 29, 28, 24, 22, 20]*pi/180</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo" id="T1:U26"><span class="var type1" id="S21T1U80">LowAlpEnd</span> = <span class="mxinfo" id="T1:U28">interp1(<span class="mxinfo" id="T31:U29"><span class="var type1" id="S17T31U83">AR_pre</span></span>,<span class="mxinfo" id="T31:U31"><span class="var type1" id="S18T31U84">LowAlpEnd_pre</span></span>,<span class="var type1" id="S12T1U85">AR</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T1:U34"><span class="var type1" id="S23T1U88">HighAlpStart</span> = <span class="mxinfo" id="T1:U36">interp1(<span class="mxinfo" id="T31:U37"><span class="var type1" id="S17T31U91">AR_pre</span></span>, <span class="mxinfo" id="T31:U39"><span class="var type1" id="S20T31U92">HighAlpStart_pre</span></span>, <span class="var type1" id="S12T1U93">AR</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%----------------------- LIFT CURVE SLOPE ---------------------------%</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo" id="T66:U42"><span class="var type1" id="S24T66U96">CLAlp_Method</span> = <span class="mxinfo" id="T66:U44"><span class="string">'McCormick'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,21" id="srcline21"> 21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,22" id="srcline22"> 22</a></span><span class="line"><span class="keyword">switch</span> <span class="var type1" id="S24T66U99">CLAlp_Method</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,23" id="srcline23"> 23</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'McCormick'</span> <span class="comment">% From McCormick</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo" id="T1:U46"><span class="var type1" id="S25T1U104">ClAlp</span> = <span class="mxinfo" id="T1:U48">2*pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo" id="T1:U49"><span class="var type1" id="S26T1U111">CLAlp</span> = <span class="mxinfo" id="T1:U51"><span class="mxinfo" id="T1:U52"><span class="mxinfo" id="T1:U53"><span class="var type1" id="S25T1U114">ClAlp</span></span>*<span class="var type1" id="S12T1U115">AR</span></span>/(<span class="mxinfo" id="T1:U56"><span class="var type1" id="S12T1U118">AR</span> + <span class="mxinfo" id="T1:U58"><span class="mxinfo" id="T1:U59"><span class="mxinfo" id="T1:U60">2</span>*(<span class="mxinfo" id="T1:U61"><span class="var type1" id="S12T1U124">AR</span>+<span class="mxinfo" id="T1:U63">4</span></span>)</span>/(<span class="mxinfo" id="T1:U64"><span class="var type1" id="S12T1U128">AR</span>+<span class="mxinfo" id="T1:U66">2</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,27" id="srcline27"> 27</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'Anderson'</span> <span class="comment">% FROM ANDERSON (THROUGH TORRES AND MUELLER)</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,28" id="srcline28"> 28</a></span><span class="line">        <span class="var type0" id="S25T0U134">ClAlp</span> = 5.3743;</span></span>
<span class="srcline"><span class="lineno"><a href="100,29" id="srcline29"> 29</a></span><span class="line">        <span class="var type0" id="S27T0U138">tau</span> = 0.3; <span class="comment">%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,30" id="srcline30"> 30</a></span><span class="line">        <span class="var type0" id="S26T0U142">CLAlp</span> = <span class="var type0" id="S25T0U144">ClAlp</span>/(1 + (1 + <span class="var type0" id="S27T0U153">tau</span>)*<span class="var type0" id="S25T0U154">ClAlp</span>/(pi*<span class="var type0" id="S12T0U159">AR</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="100,31" id="srcline31"> 31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,32" id="srcline32"> 32</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'Polhamus'</span> <span class="comment">% FROM LOWRY &amp; POLHAMUS (THROUGH TORRES)</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,33" id="srcline33"> 33</a></span><span class="line">        <span class="var type0" id="S25T0U164">ClAlp</span> = 2*pi;</span></span>
<span class="srcline"><span class="lineno"><a href="100,34" id="srcline34"> 34</a></span><span class="line">        <span class="var type0" id="S28T0U171">eta</span> = <span class="var type0" id="S25T0U173">ClAlp</span>/(2*pi);</span></span>
<span class="srcline"><span class="lineno"><a href="100,35" id="srcline35"> 35</a></span><span class="line">        <span class="var type0" id="S26T0U181">CLAlp</span> = 2*pi*<span class="var type0" id="S12T0U188">AR</span>/(2 + sqrt((<span class="var type0" id="S12T0U199">AR</span>/<span class="var type0" id="S28T0U200">eta</span>)^2*1 + 4));</span></span>
<span class="srcline"><span class="lineno"><a href="100,36" id="srcline36"> 36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,37" id="srcline37"> 37</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'Hoerner'</span> <span class="comment">% FROM HOERNER</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,38" id="srcline38"> 38</a></span><span class="line">        <span class="var type0" id="S26T0U208">CLAlp</span> = 1/(36.5/<span class="var type0" id="S12T0U217">AR</span> + 2*<span class="var type0" id="S12T0U220">AR</span>)*180/pi;</span></span>
<span class="srcline"><span class="lineno"><a href="100,39" id="srcline39"> 39</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,40" id="srcline40"> 40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">% -------- POTENTIAL LIFT AND VORTEX LIFT COEFFICIENTS --------------%</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T1:U67"><span class="var type1" id="S30T1U226">Kp</span> = <span class="var type1" id="S26T1U227">CLAlp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T1:U70"><span class="var type1" id="S31T1U230">Kv</span> = <span class="mxinfo" id="T1:U72">pi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,44" id="srcline44"> 44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%--------------------- FLAP DEFLECTION ------------------------------%</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,46" id="srcline46"> 46</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U73"><span class="mxinfo" id="T1:U74"><span class="var type1" id="S9T1U237">cf</span>/<span class="var type1" id="S10T1U238">c</span></span> == <span class="mxinfo" id="T1:U77">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo" id="T1:U78"><span class="var type1" id="S32T1U242">alp0_eff</span> = <span class="var type1" id="S15T1U243">alp0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo" id="T1:U81"><span class="var type1" id="S33T1U246">LowAlpEnd_P</span> = <span class="var type1" id="S21T1U247">LowAlpEnd</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo" id="T1:U84"><span class="var type1" id="S34T1U250">LowAlpEnd_N</span> = <span class="mxinfo" id="T1:U86">-<span class="var type1" id="S21T1U252">LowAlpEnd</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo" id="T1:U88"><span class="var type1" id="S35T1U255">LowAlpStart_P</span> = <span class="mxinfo" id="T1:U90"><span class="var type1" id="S34T1U257">LowAlpEnd_N</span> + <span class="mxinfo" id="T1:U92">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T1:U93"><span class="var type1" id="S36T1U262">LowAlpStart_N</span> = <span class="mxinfo" id="T1:U95"><span class="var type1" id="S33T1U264">LowAlpEnd_P</span> - <span class="mxinfo" id="T1:U97">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,53" id="srcline53"> 53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T1:U98"><span class="var type1" id="S37T1U269">HighAlpStart_P</span> = <span class="var type1" id="S23T1U270">HighAlpStart</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo" id="T1:U101"><span class="var type1" id="S38T1U273">HighAlpEnd_P</span> = <span class="mxinfo" id="T1:U103"><span class="mxinfo" id="T1:U104">pi</span> - <span class="var type1" id="S37T1U277">HighAlpStart_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T1:U106"><span class="var type1" id="S39T1U280">HighAlpStart_N</span> = <span class="mxinfo" id="T1:U108">-<span class="var type1" id="S37T1U282">HighAlpStart_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo" id="T1:U110"><span class="var type1" id="S40T1U285">HighAlpEnd_N</span> = <span class="mxinfo" id="T1:U112">-<span class="var type1" id="S38T1U287">HighAlpEnd_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo" id="T1:U114"><span class="var type1" id="S8T1U290">alp</span> = <span class="mxinfo" id="T1:U116"><span class="var type1" id="S8T1U292">alp</span> + <span class="var type1" id="S11T1U293">def</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo" id="T1:U119"><span class="var type1" id="S41T1U296">c_eff</span> = <span class="var type1" id="S10T1U297">c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo" id="T1:U122"><span class="var type1" id="S42T1U300">gamma</span> = <span class="mxinfo" id="T1:U124">0</span></span>;                           </span></span>
<span class="srcline"><span class="lineno"><a href="100,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,63" id="srcline63"> 63</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo" id="T1:U125"><span class="var type1" id="S43T1U305">the_f</span> = <span class="mxinfo" id="T1:U127">acos(<span class="mxinfo" id="T1:U128"><span class="mxinfo" id="T1:U129"><span class="mxinfo" id="T1:U130"><span class="mxinfo" id="T1:U131">2</span>*<span class="var type1" id="S9T1U312">cf</span></span>/<span class="var type1" id="S10T1U313">c</span></span> - <span class="mxinfo" id="T1:U134">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo" id="T1:U135"><span class="var type1" id="S27T1U317">tau</span> = <span class="mxinfo" id="T1:U137"><span class="mxinfo" id="T1:U138">1</span> - <span class="mxinfo" id="T1:U139">(<span class="mxinfo" id="T1:U140"><span class="var type1" id="S43T1U323">the_f</span> - <span class="mxinfo" id="T1:U142">sin(<span class="var type1" id="S43T1U326">the_f</span>)</span></span>)/<span class="mxinfo" id="T1:U144">pi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,66" id="srcline66"> 66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo" id="T3:U145"><span class="var type1" id="S46T3U331">cf2c_pre</span> = <span class="mxinfo" id="T3:U147">[0 0.2 0.4 0.6 0.8 1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,68" id="srcline68"> 68</a></span><span class="line">    <span class="mxinfo" id="T3:U148"><span class="var type1" id="S47T3U342">delCLmax2delCL_pre</span> = <span class="mxinfo" id="T3:U150">[1 0.83 0.65 0.3 0.15 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,69" id="srcline69"> 69</a></span><span class="line">    <span class="mxinfo" id="T1:U151"><span class="var type1" id="S48T1U353">delCLmax2delCL</span> = <span class="mxinfo" id="T1:U153">interp1(<span class="mxinfo" id="T3:U154"><span class="var type1" id="S46T3U356">cf2c_pre</span></span>,<span class="mxinfo" id="T3:U156"><span class="var type1" id="S47T3U357">delCLmax2delCL_pre</span></span>,<span class="mxinfo" id="T1:U158"><span class="var type1" id="S9T1U359">cf</span>/<span class="var type1" id="S10T1U360">c</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,71" id="srcline71"> 71</a></span><span class="line">    <span class="mxinfo" id="T68:U161"><span class="var type1" id="S49T68U363">beta_pre</span> = <span class="mxinfo" id="T68:U163">[0 10 20 30 40 50 60 70]*pi/180</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="100,72" id="srcline72"> 72</a></span><span class="line">    <span class="comment">%eta_pre = [0.81*0.7 0.8*0.7 0.685*0.7 0.535 0.455 0.405 0.37 0.345];</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,73" id="srcline73"> 73</a></span><span class="line">    <span class="mxinfo" id="T68:U164"><span class="var type1" id="S50T68U381">eta_pre</span> = <span class="mxinfo" id="T68:U166">[0.582, 0.536, 0.494, 0.456, 0.42, 0.388, 0.359, 0.333]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,74" id="srcline74"> 74</a></span><span class="line">    <span class="mxinfo" id="T1:U167"><span class="var type1" id="S28T1U394">eta</span> = <span class="mxinfo" id="T1:U169">interp1(<span class="mxinfo" id="T68:U170"><span class="var type1" id="S49T68U397">beta_pre</span></span>, <span class="mxinfo" id="T68:U172"><span class="var type1" id="S50T68U398">eta_pre</span></span>, <span class="mxinfo" id="T1:U174">abs(<span class="var type1" id="S11T1U401">def</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo" id="T1:U176"><span class="var type1" id="S52T1U404">delCL</span> = <span class="mxinfo" id="T1:U178"><span class="mxinfo" id="T1:U179"><span class="mxinfo" id="T1:U180"><span class="var type1" id="S26T1U408">CLAlp</span>*<span class="var type1" id="S27T1U409">tau</span></span>*<span class="var type1" id="S28T1U410">eta</span></span>*<span class="var type1" id="S11T1U411">def</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T1:U185"><span class="var type1" id="S53T1U414">delCLmax</span> = <span class="mxinfo" id="T1:U187"><span class="var type1" id="S48T1U416">delCLmax2delCL</span>*<span class="var type1" id="S52T1U417">delCL</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,79" id="srcline79"> 79</a></span><span class="line">    <span class="comment">% For Linear CL vs Alp curve</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,80" id="srcline80"> 80</a></span><span class="line">    <span class="comment">% alp0_eff1 = alp0 - delCL/CLAlp;                </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,81" id="srcline81"> 81</a></span><span class="line">    <span class="comment">% CLmaxP1 = CLAlp*(alpStallP - alp0) + delCLmax;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,82" id="srcline82"> 82</a></span><span class="line">    <span class="comment">% CLmaxN1 = CLAlp*(alpStallN - alp0) + delCLmax;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,83" id="srcline83"> 83</a></span><span class="line">    <span class="comment">% alpStallP_eff1 = alp0_eff1 + CLmaxP1/CLAlp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,84" id="srcline84"> 84</a></span><span class="line">    <span class="comment">% alpStallN_eff1 = alp0_eff1 + CLmaxN1/CLAlp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,86" id="srcline86"> 86</a></span><span class="line">    <span class="comment">% For Non-Linear CL vs Alp curve</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,87" id="srcline87"> 87</a></span><span class="line">    <span class="comment">%fun = @(x) Kp*sin(0-x)*(cos(0-x))^2 + Kv*abs(sin(0-x))*sin(0-x)*cos(0-x) - delCL;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,88" id="srcline88"> 88</a></span><span class="line">    <span class="mxinfo" id="T1:U190"><span class="var type1" id="S54T1U420">x0</span> = <span class="var type1" id="S15T1U421">alp0</span></span>;              </span></span>
<span class="srcline"><span class="lineno"><a href="100,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%     alp0_eff = fzero(@myfun_alp0_eff,x0,[],Kp,Kv,delCL);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,90" id="srcline90"> 90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,91" id="srcline91"> 91</a></span><span class="line">    <span class="mxinfo" id="T1:U193"><span class="var type1" id="S55T1U424">a_eff</span> = <span class="mxinfo" id="T1:U195"><span class="var type1" id="S21T1U426">LowAlpEnd</span> - <span class="var type1" id="S15T1U427">alp0</span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo" id="T1:U198"><span class="var type1" id="S56T1U430">CLmaxP</span> = <span class="mxinfo" id="T1:U200"><span class="mxinfo" id="T1:U201"><span class="mxinfo" id="T1:U202"><span class="mxinfo" id="T1:U203"><span class="var type1" id="S30T1U435">Kp</span>*<span class="mxinfo" id="T1:U205">sin(<span class="var type1" id="S55T1U438">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U207">(<span class="mxinfo" id="T1:U208">cos(<span class="var type1" id="S55T1U443">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U210"><span class="mxinfo" id="T1:U211"><span class="mxinfo" id="T1:U212"><span class="mxinfo" id="T1:U213"><span class="var type1" id="S31T1U448">Kv</span></span>*<span class="mxinfo" id="T1:U215">abs(<span class="mxinfo" id="T1:U216">sin(<span class="var type1" id="S55T1U453">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U218">sin(<span class="var type1" id="S55T1U456">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U220">cos(<span class="var type1" id="S55T1U459">a_eff</span>)</span></span></span> + <span class="var type1" id="S53T1U460">delCLmax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T1:U223"><span class="var type1" id="S55T1U463">a_eff</span> = <span class="mxinfo" id="T1:U225"><span class="mxinfo" id="T1:U226">-<span class="var type1" id="S21T1U466">LowAlpEnd</span></span> - <span class="var type1" id="S15T1U467">alp0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,94" id="srcline94"> 94</a></span><span class="line">    <span class="mxinfo" id="T1:U229"><span class="var type1" id="S58T1U470">CLmaxN</span> = <span class="mxinfo" id="T1:U231"><span class="mxinfo" id="T1:U232"><span class="mxinfo" id="T1:U233"><span class="mxinfo" id="T1:U234"><span class="var type1" id="S30T1U475">Kp</span>*<span class="mxinfo" id="T1:U236">sin(<span class="var type1" id="S55T1U478">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U238">(<span class="mxinfo" id="T1:U239">cos(<span class="var type1" id="S55T1U483">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U241"><span class="mxinfo" id="T1:U242"><span class="mxinfo" id="T1:U243"><span class="mxinfo" id="T1:U244"><span class="var type1" id="S31T1U488">Kv</span></span>*<span class="mxinfo" id="T1:U246">abs(<span class="mxinfo" id="T1:U247">sin(<span class="var type1" id="S55T1U493">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U249">sin(<span class="var type1" id="S55T1U496">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U251">cos(<span class="var type1" id="S55T1U499">a_eff</span>)</span></span></span> + <span class="var type1" id="S53T1U500">delCLmax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,96" id="srcline96"> 96</a></span><span class="line">    <span class="comment">%fun = @(x) Kp*sin(x-alp0_eff)*(cos(x-alp0_eff))^2 + Kv*abs(sin(x-alp0_eff))*sin(x-alp0_eff)*cos(x-alp0_eff) - CLmaxP;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo" id="T1:U254"><span class="var type1" id="S54T1U503">x0</span> = <span class="var type1" id="S21T1U504">LowAlpEnd</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">%     LowAlpEnd_P = fzero(@myfun_alpStall_eff,x0,[],Kp,Kv,alp0_eff,CLmaxP);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%alpStallP_eff = fzero(@myfun_alpStall_eff,x0,[],Kp,Kv,alp0_eff,CLmaxP);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%fun = @(x) Kp*sin(x-alp0_eff)*(cos(x-alp0_eff))^2 + Kv*abs(sin(x-alp0_eff))*sin(x-alp0_eff)*cos(x-alp0_eff) - CLmaxN;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,102" id="srcline102">102</a></span><span class="line">    <span class="mxinfo" id="T1:U257"><span class="var type1" id="S54T1U507">x0</span> = <span class="mxinfo" id="T1:U259">-<span class="var type1" id="S21T1U509">LowAlpEnd</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,103" id="srcline103">103</a></span><span class="line"><span class="comment">%     LowAlpEnd_N = fzero(@myfun_alpStall_eff,x0,[],Kp,Kv,alp0_eff,CLmaxN);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,104" id="srcline104">104</a></span><span class="line">    <span class="comment">%alpStallN_eff = fzero(@myfun_alpStall_eff,x0,[],Kp,Kv,alp0_eff,CLmaxN);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,106" id="srcline106">106</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T4:U261"><span class="mxinfo" id="T1:U262">abs(<span class="mxinfo" id="T1:U263"><span class="var type1" id="S12T1U516">AR</span>-<span class="mxinfo" id="T1:U265">2.09200</span></span>)</span> &lt; <span class="mxinfo" id="T1:U266">0.0009</span></span> <span class="comment">%wing</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,107" id="srcline107">107</a></span><span class="line">        <span class="mxinfo" id="T22:U267"><span class="var type1" id="S59T22U521">p_a0_w</span> = <span class="mxinfo" id="T22:U269">[0.1145    0.0000   -0.3372   -0.0000]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,108" id="srcline108">108</a></span><span class="line">        <span class="mxinfo" id="T1:U270"><span class="var type1" id="S32T1U532">alp0_eff</span> = <span class="mxinfo" id="T1:U272"><span class="mxinfo" id="T1:U273"><span class="mxinfo" id="T1:U274"><span class="mxinfo" id="T1:U275"><span class="mxinfo" id="T1:U276"><span class="var type1" id="S59T22U538">p_a0_w</span>(1)</span>*<span class="mxinfo" id="T1:U278"><span class="var type1" id="S11T1U541">def</span>^3</span></span> + <span class="mxinfo" id="T1:U280"><span class="mxinfo" id="T1:U281"><span class="var type1" id="S59T22U545">p_a0_w</span>(2)</span>*<span class="mxinfo" id="T1:U283"><span class="var type1" id="S11T1U548">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U285"><span class="mxinfo" id="T1:U286"><span class="var type1" id="S59T22U552">p_a0_w</span>(3)</span>*<span class="var type1" id="S11T1U554">def</span></span></span> + <span class="mxinfo" id="T1:U289"><span class="var type1" id="S59T22U556">p_a0_w</span>(<span class="mxinfo" id="T1:U291">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,109" id="srcline109">109</a></span><span class="line">        <span class="mxinfo" id="T22:U292"><span class="var type1" id="S60T22U560">p_aP_w</span> = <span class="mxinfo" id="T22:U294">[0.0678    0.0009   -0.1636    0.2713]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,110" id="srcline110">110</a></span><span class="line">        <span class="mxinfo" id="T1:U295"><span class="var type1" id="S33T1U570">LowAlpEnd_P</span> = <span class="mxinfo" id="T1:U297"><span class="mxinfo" id="T1:U298"><span class="mxinfo" id="T1:U299"><span class="mxinfo" id="T1:U300"><span class="mxinfo" id="T1:U301"><span class="var type1" id="S60T22U576">p_aP_w</span>(1)</span>*<span class="mxinfo" id="T1:U303"><span class="var type1" id="S11T1U579">def</span>^3</span></span> + <span class="mxinfo" id="T1:U305"><span class="mxinfo" id="T1:U306"><span class="var type1" id="S60T22U583">p_aP_w</span>(2)</span>*<span class="mxinfo" id="T1:U308"><span class="var type1" id="S11T1U586">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U310"><span class="mxinfo" id="T1:U311"><span class="var type1" id="S60T22U590">p_aP_w</span>(3)</span>*<span class="var type1" id="S11T1U592">def</span></span></span> + <span class="mxinfo" id="T1:U314"><span class="var type1" id="S60T22U594">p_aP_w</span>(<span class="mxinfo" id="T1:U316">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,111" id="srcline111">111</a></span><span class="line">        <span class="mxinfo" id="T22:U317"><span class="var type1" id="S61T22U598">p_aN_w</span> = <span class="mxinfo" id="T22:U319">[0.0678   -0.0009   -0.1636   -0.2713]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,112" id="srcline112">112</a></span><span class="line">        <span class="mxinfo" id="T1:U320"><span class="var type1" id="S34T1U610">LowAlpEnd_N</span> = <span class="mxinfo" id="T1:U322"><span class="mxinfo" id="T1:U323"><span class="mxinfo" id="T1:U324"><span class="mxinfo" id="T1:U325"><span class="mxinfo" id="T1:U326"><span class="var type1" id="S61T22U616">p_aN_w</span>(1)</span>*<span class="mxinfo" id="T1:U328"><span class="var type1" id="S11T1U619">def</span>^3</span></span> + <span class="mxinfo" id="T1:U330"><span class="mxinfo" id="T1:U331"><span class="var type1" id="S61T22U623">p_aN_w</span>(2)</span>*<span class="mxinfo" id="T1:U333"><span class="var type1" id="S11T1U626">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U335"><span class="mxinfo" id="T1:U336"><span class="var type1" id="S61T22U630">p_aN_w</span>(3)</span>*<span class="var type1" id="S11T1U632">def</span></span></span> + <span class="mxinfo" id="T1:U339"><span class="var type1" id="S61T22U634">p_aN_w</span>(<span class="mxinfo" id="T1:U341">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,113" id="srcline113">113</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U342"><span class="mxinfo" id="T1:U343">abs(<span class="mxinfo" id="T1:U344"><span class="var type1" id="S12T1U641">AR</span>-<span class="mxinfo" id="T1:U346">0.227938</span></span>)</span> &lt; <span class="mxinfo" id="T1:U347">0.0009</span></span> <span class="comment">%body</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,114" id="srcline114">114</a></span><span class="line">        <span class="mxinfo" id="T22:U348"><span class="var type1" id="S62T22U646">p_a0_B</span> = <span class="mxinfo" id="T22:U350">[0 0 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,115" id="srcline115">115</a></span><span class="line">        <span class="mxinfo" id="T1:U351"><span class="var type1" id="S32T1U655">alp0_eff</span> = <span class="mxinfo" id="T1:U353"><span class="mxinfo" id="T1:U354"><span class="mxinfo" id="T1:U355"><span class="mxinfo" id="T1:U356"><span class="mxinfo" id="T1:U357"><span class="var type1" id="S62T22U661">p_a0_B</span>(1)</span>*<span class="mxinfo" id="T1:U359"><span class="var type1" id="S11T1U664">def</span>^3</span></span> + <span class="mxinfo" id="T1:U361"><span class="mxinfo" id="T1:U362"><span class="var type1" id="S62T22U668">p_a0_B</span>(2)</span>*<span class="mxinfo" id="T1:U364"><span class="var type1" id="S11T1U671">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U366"><span class="mxinfo" id="T1:U367"><span class="var type1" id="S62T22U675">p_a0_B</span>(3)</span>*<span class="var type1" id="S11T1U677">def</span></span></span> + <span class="mxinfo" id="T1:U370"><span class="var type1" id="S62T22U679">p_a0_B</span>(<span class="mxinfo" id="T1:U372">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,116" id="srcline116">116</a></span><span class="line">        <span class="mxinfo" id="T22:U373"><span class="var type1" id="S63T22U683">p_aP_B</span> = <span class="mxinfo" id="T22:U375">[0 0 0 0.5842]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,117" id="srcline117">117</a></span><span class="line">        <span class="mxinfo" id="T1:U376"><span class="var type1" id="S33T1U692">LowAlpEnd_P</span> = <span class="mxinfo" id="T1:U378"><span class="mxinfo" id="T1:U379"><span class="mxinfo" id="T1:U380"><span class="mxinfo" id="T1:U381"><span class="mxinfo" id="T1:U382"><span class="var type1" id="S63T22U698">p_aP_B</span>(1)</span>*<span class="mxinfo" id="T1:U384"><span class="var type1" id="S11T1U701">def</span>^3</span></span> + <span class="mxinfo" id="T1:U386"><span class="mxinfo" id="T1:U387"><span class="var type1" id="S63T22U705">p_aP_B</span>(2)</span>*<span class="mxinfo" id="T1:U389"><span class="var type1" id="S11T1U708">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U391"><span class="mxinfo" id="T1:U392"><span class="var type1" id="S63T22U712">p_aP_B</span>(3)</span>*<span class="var type1" id="S11T1U714">def</span></span></span> + <span class="mxinfo" id="T1:U395"><span class="var type1" id="S63T22U716">p_aP_B</span>(<span class="mxinfo" id="T1:U397">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,118" id="srcline118">118</a></span><span class="line">        <span class="mxinfo" id="T22:U398"><span class="var type1" id="S64T22U720">p_aN_B</span> = <span class="mxinfo" id="T22:U400">[0 0 0 -0.5842]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,119" id="srcline119">119</a></span><span class="line">        <span class="mxinfo" id="T1:U401"><span class="var type1" id="S34T1U730">LowAlpEnd_N</span> = <span class="mxinfo" id="T1:U403"><span class="mxinfo" id="T1:U404"><span class="mxinfo" id="T1:U405"><span class="mxinfo" id="T1:U406"><span class="mxinfo" id="T1:U407"><span class="var type1" id="S64T22U736">p_aN_B</span>(1)</span>*<span class="mxinfo" id="T1:U409"><span class="var type1" id="S11T1U739">def</span>^3</span></span> + <span class="mxinfo" id="T1:U411"><span class="mxinfo" id="T1:U412"><span class="var type1" id="S64T22U743">p_aN_B</span>(2)</span>*<span class="mxinfo" id="T1:U414"><span class="var type1" id="S11T1U746">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U416"><span class="mxinfo" id="T1:U417"><span class="var type1" id="S64T22U750">p_aN_B</span>(3)</span>*<span class="var type1" id="S11T1U752">def</span></span></span> + <span class="mxinfo" id="T1:U420"><span class="var type1" id="S64T22U754">p_aN_B</span>(<span class="mxinfo" id="T1:U422">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,120" id="srcline120">120</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U423"><span class="mxinfo" id="T1:U424">abs(<span class="mxinfo" id="T1:U425"><span class="var type1" id="S12T1U761">AR</span>-<span class="mxinfo" id="T1:U427">1.298412</span></span>)</span> &lt; <span class="mxinfo" id="T1:U428">0.0009</span></span> <span class="comment">%rud</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,121" id="srcline121">121</a></span><span class="line">        <span class="mxinfo" id="T22:U429"><span class="var type1" id="S65T22U766">p_a0_r</span> = <span class="mxinfo" id="T22:U431">[0.1263    0.0000   -0.3456         0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,122" id="srcline122">122</a></span><span class="line">        <span class="mxinfo" id="T1:U432"><span class="var type1" id="S32T1U776">alp0_eff</span> = <span class="mxinfo" id="T1:U434"><span class="mxinfo" id="T1:U435"><span class="mxinfo" id="T1:U436"><span class="mxinfo" id="T1:U437"><span class="mxinfo" id="T1:U438"><span class="var type1" id="S65T22U782">p_a0_r</span>(1)</span>*<span class="mxinfo" id="T1:U440"><span class="var type1" id="S11T1U785">def</span>^3</span></span> + <span class="mxinfo" id="T1:U442"><span class="mxinfo" id="T1:U443"><span class="var type1" id="S65T22U789">p_a0_r</span>(2)</span>*<span class="mxinfo" id="T1:U445"><span class="var type1" id="S11T1U792">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U447"><span class="mxinfo" id="T1:U448"><span class="var type1" id="S65T22U796">p_a0_r</span>(3)</span>*<span class="var type1" id="S11T1U798">def</span></span></span> + <span class="mxinfo" id="T1:U451"><span class="var type1" id="S65T22U800">p_a0_r</span>(<span class="mxinfo" id="T1:U453">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,123" id="srcline123">123</a></span><span class="line">        <span class="mxinfo" id="T22:U454"><span class="var type1" id="S66T22U804">p_aP_r</span> = <span class="mxinfo" id="T22:U456">[0.0951    0.0015   -0.2331    0.3610]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,124" id="srcline124">124</a></span><span class="line">        <span class="mxinfo" id="T1:U457"><span class="var type1" id="S33T1U814">LowAlpEnd_P</span> = <span class="mxinfo" id="T1:U459"><span class="mxinfo" id="T1:U460"><span class="mxinfo" id="T1:U461"><span class="mxinfo" id="T1:U462"><span class="mxinfo" id="T1:U463"><span class="var type1" id="S66T22U820">p_aP_r</span>(1)</span>*<span class="mxinfo" id="T1:U465"><span class="var type1" id="S11T1U823">def</span>^3</span></span> + <span class="mxinfo" id="T1:U467"><span class="mxinfo" id="T1:U468"><span class="var type1" id="S66T22U827">p_aP_r</span>(2)</span>*<span class="mxinfo" id="T1:U470"><span class="var type1" id="S11T1U830">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U472"><span class="mxinfo" id="T1:U473"><span class="var type1" id="S66T22U834">p_aP_r</span>(3)</span>*<span class="var type1" id="S11T1U836">def</span></span></span> + <span class="mxinfo" id="T1:U476"><span class="var type1" id="S66T22U838">p_aP_r</span>(<span class="mxinfo" id="T1:U478">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,125" id="srcline125">125</a></span><span class="line">        <span class="mxinfo" id="T22:U479"><span class="var type1" id="S67T22U842">p_aN_r</span> = <span class="mxinfo" id="T22:U481">[0.0951   -0.0015   -0.2331   -0.3610]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,126" id="srcline126">126</a></span><span class="line">        <span class="mxinfo" id="T1:U482"><span class="var type1" id="S34T1U854">LowAlpEnd_N</span> = <span class="mxinfo" id="T1:U484"><span class="mxinfo" id="T1:U485"><span class="mxinfo" id="T1:U486"><span class="mxinfo" id="T1:U487"><span class="mxinfo" id="T1:U488"><span class="var type1" id="S67T22U860">p_aN_r</span>(1)</span>*<span class="mxinfo" id="T1:U490"><span class="var type1" id="S11T1U863">def</span>^3</span></span> + <span class="mxinfo" id="T1:U492"><span class="mxinfo" id="T1:U493"><span class="var type1" id="S67T22U867">p_aN_r</span>(2)</span>*<span class="mxinfo" id="T1:U495"><span class="var type1" id="S11T1U870">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U497"><span class="mxinfo" id="T1:U498"><span class="var type1" id="S67T22U874">p_aN_r</span>(3)</span>*<span class="var type1" id="S11T1U876">def</span></span></span> + <span class="mxinfo" id="T1:U501"><span class="var type1" id="S67T22U878">p_aN_r</span>(<span class="mxinfo" id="T1:U503">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,127" id="srcline127">127</a></span><span class="line">    <span class="keyword">else</span> <span class="comment">%tail</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,128" id="srcline128">128</a></span><span class="line">        <span class="mxinfo" id="T22:U504"><span class="var type1" id="S68T22U883">p_a0_t</span> = <span class="mxinfo" id="T22:U506">[0.1381   -0.0000   -0.3734   -0.0000]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,129" id="srcline129">129</a></span><span class="line">        <span class="mxinfo" id="T1:U507"><span class="var type1" id="S32T1U895">alp0_eff</span> = <span class="mxinfo" id="T1:U509"><span class="mxinfo" id="T1:U510"><span class="mxinfo" id="T1:U511"><span class="mxinfo" id="T1:U512"><span class="mxinfo" id="T1:U513"><span class="var type1" id="S68T22U901">p_a0_t</span>(1)</span>*<span class="mxinfo" id="T1:U515"><span class="var type1" id="S11T1U904">def</span>^3</span></span> + <span class="mxinfo" id="T1:U517"><span class="mxinfo" id="T1:U518"><span class="var type1" id="S68T22U908">p_a0_t</span>(2)</span>*<span class="mxinfo" id="T1:U520"><span class="var type1" id="S11T1U911">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U522"><span class="mxinfo" id="T1:U523"><span class="var type1" id="S68T22U915">p_a0_t</span>(3)</span>*<span class="var type1" id="S11T1U917">def</span></span></span> + <span class="mxinfo" id="T1:U526"><span class="var type1" id="S68T22U919">p_a0_t</span>(<span class="mxinfo" id="T1:U528">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,130" id="srcline130">130</a></span><span class="line">        <span class="mxinfo" id="T22:U529"><span class="var type1" id="S69T22U923">p_aP_t</span> = <span class="mxinfo" id="T22:U531">[0.1196    0.0006   -0.3079    0.3726]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,131" id="srcline131">131</a></span><span class="line">        <span class="mxinfo" id="T1:U532"><span class="var type1" id="S33T1U933">LowAlpEnd_P</span> = <span class="mxinfo" id="T1:U534"><span class="mxinfo" id="T1:U535"><span class="mxinfo" id="T1:U536"><span class="mxinfo" id="T1:U537"><span class="mxinfo" id="T1:U538"><span class="var type1" id="S69T22U939">p_aP_t</span>(1)</span>*<span class="mxinfo" id="T1:U540"><span class="var type1" id="S11T1U942">def</span>^3</span></span> + <span class="mxinfo" id="T1:U542"><span class="mxinfo" id="T1:U543"><span class="var type1" id="S69T22U946">p_aP_t</span>(2)</span>*<span class="mxinfo" id="T1:U545"><span class="var type1" id="S11T1U949">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U547"><span class="mxinfo" id="T1:U548"><span class="var type1" id="S69T22U953">p_aP_t</span>(3)</span>*<span class="var type1" id="S11T1U955">def</span></span></span> + <span class="mxinfo" id="T1:U551"><span class="var type1" id="S69T22U957">p_aP_t</span>(<span class="mxinfo" id="T1:U553">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,132" id="srcline132">132</a></span><span class="line">        <span class="mxinfo" id="T22:U554"><span class="var type1" id="S70T22U961">p_aN_t</span> = <span class="mxinfo" id="T22:U556">[0.1196   -0.0006   -0.3079   -0.3726]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,133" id="srcline133">133</a></span><span class="line">        <span class="mxinfo" id="T1:U557"><span class="var type1" id="S34T1U973">LowAlpEnd_N</span> = <span class="mxinfo" id="T1:U559"><span class="mxinfo" id="T1:U560"><span class="mxinfo" id="T1:U561"><span class="mxinfo" id="T1:U562"><span class="mxinfo" id="T1:U563"><span class="var type1" id="S70T22U979">p_aN_t</span>(1)</span>*<span class="mxinfo" id="T1:U565"><span class="var type1" id="S11T1U982">def</span>^3</span></span> + <span class="mxinfo" id="T1:U567"><span class="mxinfo" id="T1:U568"><span class="var type1" id="S70T22U986">p_aN_t</span>(2)</span>*<span class="mxinfo" id="T1:U570"><span class="var type1" id="S11T1U989">def</span>^2</span></span></span> + <span class="mxinfo" id="T1:U572"><span class="mxinfo" id="T1:U573"><span class="var type1" id="S70T22U993">p_aN_t</span>(3)</span>*<span class="var type1" id="S11T1U995">def</span></span></span> + <span class="mxinfo" id="T1:U576"><span class="var type1" id="S70T22U997">p_aN_t</span>(<span class="mxinfo" id="T1:U578">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,134" id="srcline134">134</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,135" id="srcline135">135</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo" id="T1:U579"><span class="var type1" id="S35T1U1001">LowAlpStart_P</span> = <span class="mxinfo" id="T1:U581"><span class="var type1" id="S34T1U1003">LowAlpEnd_N</span> + <span class="mxinfo" id="T1:U583">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo" id="T1:U584"><span class="var type1" id="S36T1U1008">LowAlpStart_N</span> = <span class="mxinfo" id="T1:U586"><span class="var type1" id="S33T1U1010">LowAlpEnd_P</span> - <span class="mxinfo" id="T1:U588">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,138" id="srcline138">138</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,139" id="srcline139">139</a></span><span class="line">    <span class="comment">% High AoA parameters using equivalent flat plate method</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo" id="T1:U589"><span class="var type1" id="S41T1U1015">c_eff</span> = <span class="mxinfo" id="T1:U591">sqrt(<span class="mxinfo" id="T1:U592"><span class="mxinfo" id="T1:U593"><span class="mxinfo" id="T1:U594">(<span class="mxinfo" id="T1:U595"><span class="var type1" id="S10T1U1023">c</span>-<span class="var type1" id="S9T1U1024">cf</span></span>)^2</span> + <span class="mxinfo" id="T1:U598"><span class="var type1" id="S9T1U1027">cf</span>^2</span></span> + <span class="mxinfo" id="T1:U600"><span class="mxinfo" id="T1:U601"><span class="mxinfo" id="T1:U602"><span class="mxinfo" id="T1:U603">2</span>*(<span class="mxinfo" id="T1:U604"><span class="var type1" id="S10T1U1035">c</span>-<span class="var type1" id="S9T1U1036">cf</span></span>)</span>*<span class="var type1" id="S9T1U1037">cf</span></span>*<span class="mxinfo" id="T1:U608">cos(<span class="mxinfo" id="T1:U609">abs(<span class="var type1" id="S11T1U1042">def</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo" id="T1:U611"><span class="var type1" id="S42T1U1045">gamma</span> = <span class="mxinfo" id="T1:U613">asin(<span class="mxinfo" id="T1:U614"><span class="mxinfo" id="T1:U615"><span class="mxinfo" id="T1:U616">sin(<span class="var type1" id="S11T1U1052">def</span>)</span>*<span class="var type1" id="S9T1U1053">cf</span></span>/<span class="var type1" id="S41T1U1054">c_eff</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,142" id="srcline142">142</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T1:U620"><span class="var type1" id="S37T1U1057">HighAlpStart_P</span> = <span class="var type1" id="S23T1U1058">HighAlpStart</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,144" id="srcline144">144</a></span><span class="line">    <span class="mxinfo" id="T1:U623"><span class="var type1" id="S38T1U1061">HighAlpEnd_P</span> = <span class="mxinfo" id="T1:U625"><span class="mxinfo" id="T1:U626">pi</span> - <span class="var type1" id="S37T1U1065">HighAlpStart_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo" id="T1:U628"><span class="var type1" id="S39T1U1068">HighAlpStart_N</span> = <span class="mxinfo" id="T1:U630">-<span class="var type1" id="S37T1U1070">HighAlpStart_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,146" id="srcline146">146</a></span><span class="line">    <span class="mxinfo" id="T1:U632"><span class="var type1" id="S40T1U1073">HighAlpEnd_N</span> = <span class="mxinfo" id="T1:U634">-<span class="var type1" id="S38T1U1075">HighAlpEnd_P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,147" id="srcline147">147</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,148" id="srcline148">148</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,149" id="srcline149">149</a></span><span class="line">    <span class="comment">%% Calculate Aerodynamic coefficients based on regime    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,150" id="srcline150">150</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T4:U636"><span class="var type1" id="S8T1U1080">alp</span> &gt;= <span class="mxinfo" id="T1:U638">-<span class="mxinfo" id="T1:U639">pi</span></span></span> &amp;&amp; <span class="mxinfo" id="T4:U640"><span class="var type1" id="S8T1U1085">alp</span> &lt;= <span class="var type1" id="S36T1U1086">LowAlpStart_N</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,151" id="srcline151">151</a></span><span class="line">        <span class="mxinfo" id="T1:U643"><span class="var type1" id="S6T1U1089">Reg</span> = <span class="mxinfo" id="T1:U645">-<span class="mxinfo" id="T1:U646">4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,152" id="srcline152">152</a></span><span class="line">        <span class="mxinfo" id="T1:U647"><span class="var type1" id="S55T1U1094">a_eff</span> = <span class="mxinfo" id="T1:U649"><span class="mxinfo" id="T1:U650"><span class="var type1" id="S8T1U1097">alp</span> - <span class="var type1" id="S32T1U1098">alp0_eff</span></span> + <span class="mxinfo" id="T1:U653">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,153" id="srcline153">153</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,154" id="srcline154">154</a></span><span class="line">        <span class="mxinfo" id="T1:U654"><span class="var type1" id="S3T1U1103">CL</span> = <span class="mxinfo" id="T1:U656"><span class="mxinfo" id="T1:U657"><span class="mxinfo" id="T1:U658"><span class="var type1" id="S30T1U1107">Kp</span>*<span class="mxinfo" id="T1:U660">sin(<span class="var type1" id="S55T1U1110">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U662">(<span class="mxinfo" id="T1:U663">cos(<span class="var type1" id="S55T1U1115">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U665"><span class="mxinfo" id="T1:U666"><span class="mxinfo" id="T1:U667"><span class="mxinfo" id="T1:U668"><span class="var type1" id="S31T1U1120">Kv</span></span>*<span class="mxinfo" id="T1:U670">abs(<span class="mxinfo" id="T1:U671">sin(<span class="var type1" id="S55T1U1125">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U673">sin(<span class="var type1" id="S55T1U1128">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U675">cos(<span class="var type1" id="S55T1U1131">a_eff</span>)</span></span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,155" id="srcline155">155</a></span><span class="line">        <span class="mxinfo" id="T1:U677"><span class="var type1" id="S4T1U1134">CD</span> = <span class="mxinfo" id="T1:U679"><span class="var type1" id="S13T1U1136">Cd0</span> + <span class="mxinfo" id="T1:U681">abs(<span class="mxinfo" id="T1:U682"><span class="mxinfo" id="T1:U683"><span class="mxinfo" id="T1:U684"><span class="mxinfo" id="T1:U685"><span class="var type1" id="S30T1U1143">Kp</span>*<span class="mxinfo" id="T1:U687">abs(<span class="mxinfo" id="T1:U688">sin(<span class="var type1" id="S55T1U1148">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U690">sin(<span class="var type1" id="S55T1U1151">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U692">cos(<span class="var type1" id="S55T1U1154">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U694"><span class="mxinfo" id="T1:U695"><span class="var type1" id="S31T1U1156">Kv</span></span>*<span class="mxinfo" id="T1:U697">(<span class="mxinfo" id="T1:U698">sin(<span class="var type1" id="S55T1U1161">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,156" id="srcline156">156</a></span><span class="line">        <span class="mxinfo" id="T1:U700"><span class="var type1" id="S2T1U1165">CN</span> = <span class="mxinfo" id="T1:U702">-(<span class="mxinfo" id="T1:U703"><span class="mxinfo" id="T1:U704"><span class="mxinfo" id="T1:U705"><span class="var type1" id="S30T1U1171">Kp</span>*<span class="mxinfo" id="T1:U707">sin(<span class="var type1" id="S55T1U1174">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U709">abs(<span class="mxinfo" id="T1:U710">cos(<span class="var type1" id="S55T1U1179">a_eff</span>)</span>)</span></span> + <span class="mxinfo" id="T1:U712"><span class="mxinfo" id="T1:U713"><span class="mxinfo" id="T1:U714"><span class="var type1" id="S31T1U1182">Kv</span></span>*<span class="mxinfo" id="T1:U716">abs(<span class="mxinfo" id="T1:U717">sin(<span class="var type1" id="S55T1U1187">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U719">sin(<span class="var type1" id="S55T1U1190">a_eff</span>)</span></span></span>)</span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,157" id="srcline157">157</a></span><span class="line">        <span class="comment">%CM = (0.42-0.25)*Kv*abs(sin(a_eff))*sin(a_eff);</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,158" id="srcline158">158</a></span><span class="line">        <span class="mxinfo" id="T1:U721"><span class="var type1" id="S5T1U1193">CM</span> = <span class="mxinfo" id="T1:U723"><span class="mxinfo" id="T1:U724">-(<span class="mxinfo" id="T1:U725"><span class="mxinfo" id="T1:U726">0.25</span>-<span class="mxinfo" id="T1:U727"><span class="mxinfo" id="T1:U728">0.175</span>*(<span class="mxinfo" id="T1:U729"><span class="mxinfo" id="T1:U730">1</span>-<span class="mxinfo" id="T1:U731"><span class="mxinfo" id="T1:U732">abs(<span class="mxinfo" id="T1:U733"><span class="var type1" id="S55T1U1208">a_eff</span>-<span class="mxinfo" id="T1:U735">pi</span></span>)</span>/(<span class="mxinfo" id="T1:U736">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S2T1U1216">CN</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,159" id="srcline159">159</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="100,160" id="srcline160">160</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,161" id="srcline161">161</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U738"><span class="var type1" id="S8T1U1220">alp</span> &gt; <span class="var type1" id="S36T1U1221">LowAlpStart_N</span></span> &amp;&amp; <span class="mxinfo" id="T4:U741"><span class="var type1" id="S8T1U1223">alp</span> &lt; <span class="var type1" id="S40T1U1224">HighAlpEnd_N</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,162" id="srcline162">162</a></span><span class="line">        <span class="mxinfo" id="T1:U744"><span class="var type1" id="S6T1U1227">Reg</span> = <span class="mxinfo" id="T1:U746">-<span class="mxinfo" id="T1:U747">3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,163" id="srcline163">163</a></span><span class="line">        <span class="comment">% Linear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,164" id="srcline164">164</a></span><span class="line">        <span class="mxinfo" id="T1:U748"><span class="var type1" id="S55T1U1232">a_eff</span> = <span class="mxinfo" id="T1:U750"><span class="mxinfo" id="T1:U751"><span class="var type1" id="S36T1U1235">LowAlpStart_N</span> - <span class="var type1" id="S32T1U1236">alp0_eff</span></span> + <span class="mxinfo" id="T1:U754">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,165" id="srcline165">165</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,166" id="srcline166">166</a></span><span class="line">        <span class="mxinfo" id="T1:U755"><span class="var type1" id="S72T1U1241">CL1</span> = <span class="mxinfo" id="T1:U757"><span class="mxinfo" id="T1:U758"><span class="mxinfo" id="T1:U759"><span class="var type1" id="S30T1U1245">Kp</span>*<span class="mxinfo" id="T1:U761">sin(<span class="var type1" id="S55T1U1248">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U763">(<span class="mxinfo" id="T1:U764">cos(<span class="var type1" id="S55T1U1253">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U766"><span class="mxinfo" id="T1:U767"><span class="mxinfo" id="T1:U768"><span class="mxinfo" id="T1:U769"><span class="var type1" id="S31T1U1258">Kv</span></span>*<span class="mxinfo" id="T1:U771">abs(<span class="mxinfo" id="T1:U772">sin(<span class="var type1" id="S55T1U1263">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U774">sin(<span class="var type1" id="S55T1U1266">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U776">cos(<span class="var type1" id="S55T1U1269">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,167" id="srcline167">167</a></span><span class="line">        <span class="mxinfo" id="T1:U778"><span class="var type1" id="S73T1U1272">CD1</span> = <span class="mxinfo" id="T1:U780"><span class="var type1" id="S13T1U1274">Cd0</span> + <span class="mxinfo" id="T1:U782">abs(<span class="mxinfo" id="T1:U783"><span class="mxinfo" id="T1:U784"><span class="mxinfo" id="T1:U785"><span class="mxinfo" id="T1:U786"><span class="var type1" id="S30T1U1281">Kp</span>*<span class="mxinfo" id="T1:U788">abs(<span class="mxinfo" id="T1:U789">sin(<span class="var type1" id="S55T1U1286">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U791">sin(<span class="var type1" id="S55T1U1289">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U793">cos(<span class="var type1" id="S55T1U1292">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U795"><span class="mxinfo" id="T1:U796"><span class="var type1" id="S31T1U1294">Kv</span></span>*<span class="mxinfo" id="T1:U798">(<span class="mxinfo" id="T1:U799">sin(<span class="var type1" id="S55T1U1299">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,168" id="srcline168">168</a></span><span class="line">        <span class="mxinfo" id="T1:U801"><span class="var type1" id="S74T1U1303">CN1</span> = <span class="mxinfo" id="T1:U803">-(<span class="mxinfo" id="T1:U804"><span class="mxinfo" id="T1:U805"><span class="mxinfo" id="T1:U806"><span class="var type1" id="S30T1U1309">Kp</span>*<span class="mxinfo" id="T1:U808">sin(<span class="var type1" id="S55T1U1312">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U810">cos(<span class="var type1" id="S55T1U1315">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U812"><span class="mxinfo" id="T1:U813"><span class="mxinfo" id="T1:U814"><span class="var type1" id="S31T1U1318">Kv</span></span>*<span class="mxinfo" id="T1:U816">abs(<span class="mxinfo" id="T1:U817">sin(<span class="var type1" id="S55T1U1323">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U819">sin(<span class="var type1" id="S55T1U1326">a_eff</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,169" id="srcline169">169</a></span><span class="line">        <span class="comment">%CM1 = (0.42-0.25)*Kv*abs(sin(a_eff))*sin(a_eff);        </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,170" id="srcline170">170</a></span><span class="line">        <span class="comment">%CD1 = Cd0 + abs(CL1)*abs(tan(a_eff));</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,171" id="srcline171">171</a></span><span class="line">        <span class="comment">%CN1 = -sqrt(CL1^2 + CD1^2);        </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,172" id="srcline172">172</a></span><span class="line">        <span class="mxinfo" id="T1:U821"><span class="var type1" id="S75T1U1329">CM1</span> = <span class="mxinfo" id="T1:U823"><span class="mxinfo" id="T1:U824">-(<span class="mxinfo" id="T1:U825"><span class="mxinfo" id="T1:U826">0.25</span>-<span class="mxinfo" id="T1:U827"><span class="mxinfo" id="T1:U828">0.175</span>*(<span class="mxinfo" id="T1:U829"><span class="mxinfo" id="T1:U830">1</span>-<span class="mxinfo" id="T1:U831"><span class="mxinfo" id="T1:U832">abs(<span class="mxinfo" id="T1:U833"><span class="var type1" id="S55T1U1344">a_eff</span>-<span class="mxinfo" id="T1:U835">pi</span></span>)</span>/(<span class="mxinfo" id="T1:U836">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S74T1U1352">CN1</span></span></span>;           </span></span>
<span class="srcline"><span class="lineno"><a href="100,173" id="srcline173">173</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,174" id="srcline174">174</a></span><span class="line">        <span class="comment">% NonLinear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,175" id="srcline175">175</a></span><span class="line">        <span class="mxinfo" id="T1:U838"><span class="var type1" id="S55T1U1355">a_eff</span> = <span class="mxinfo" id="T1:U840"><span class="var type1" id="S40T1U1357">HighAlpEnd_N</span> + <span class="var type1" id="S42T1U1358">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,176" id="srcline176">176</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,177" id="srcline177">177</a></span><span class="line">        <span class="comment">% Determining effective Cd90</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,178" id="srcline178">178</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U843"><span class="mxinfo" id="T1:U844"><span class="var type1" id="S9T1U1364">cf</span>/<span class="var type1" id="S10T1U1365">c</span></span> == <span class="mxinfo" id="T1:U847">1</span></span> || <span class="mxinfo" id="T4:U848"><span class="mxinfo" id="T1:U849"><span class="var type1" id="S9T1U1369">cf</span>/<span class="var type1" id="S10T1U1370">c</span></span> == <span class="mxinfo" id="T1:U852">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,179" id="srcline179">179</a></span><span class="line">            <span class="mxinfo" id="T1:U853"><span class="var type1" id="S76T1U1374">Cd90_eff</span> = <span class="var type1" id="S14T1U1375">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,180" id="srcline180">180</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U856"><span class="mxinfo" id="T1:U857">sign(<span class="var type1" id="S40T1U1380">HighAlpEnd_N</span>)</span> == <span class="mxinfo" id="T1:U859">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,181" id="srcline181">181</a></span><span class="line">            <span class="mxinfo" id="T1:U860"><span class="var type1" id="S76T1U1384">Cd90_eff</span> = <span class="mxinfo" id="T1:U862"><span class="mxinfo" id="T1:U863"><span class="mxinfo" id="T1:U864"><span class="mxinfo" id="T1:U865">-1.29630E-05</span>*<span class="mxinfo" id="T1:U866">(<span class="mxinfo" id="T1:U867"><span class="mxinfo" id="T1:U868"><span class="var type1" id="S11T1U1394">def</span>*<span class="mxinfo" id="T1:U870">180</span></span>/<span class="mxinfo" id="T1:U871">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U872"><span class="mxinfo" id="T1:U873">3.61111E-03</span>*(<span class="mxinfo" id="T1:U874"><span class="mxinfo" id="T1:U875"><span class="var type1" id="S11T1U1404">def</span>*<span class="mxinfo" id="T1:U877">180</span></span>/<span class="mxinfo" id="T1:U878">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1408">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,182" id="srcline182">182</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,183" id="srcline183">183</a></span><span class="line">            <span class="mxinfo" id="T1:U880"><span class="var type1" id="S76T1U1412">Cd90_eff</span> = <span class="mxinfo" id="T1:U882"><span class="mxinfo" id="T1:U883"><span class="mxinfo" id="T1:U884"><span class="mxinfo" id="T1:U885">-1.29630E-05</span>*<span class="mxinfo" id="T1:U886">(<span class="mxinfo" id="T1:U887"><span class="mxinfo" id="T1:U888"><span class="var type1" id="S11T1U1422">def</span>*<span class="mxinfo" id="T1:U890">180</span></span>/<span class="mxinfo" id="T1:U891">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U892"><span class="mxinfo" id="T1:U893">3.61111E-03</span>*(<span class="mxinfo" id="T1:U894"><span class="mxinfo" id="T1:U895"><span class="var type1" id="S11T1U1432">def</span>*<span class="mxinfo" id="T1:U897">180</span></span>/<span class="mxinfo" id="T1:U898">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1436">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,184" id="srcline184">184</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,185" id="srcline185">185</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,186" id="srcline186">186</a></span><span class="line">        <span class="comment">% Hoerner Model with Lindenberg Correction</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,187" id="srcline187">187</a></span><span class="line">        <span class="mxinfo" id="T1:U900"><span class="var type1" id="S78T1U1439">CN2</span> = <span class="mxinfo" id="T1:U902"><span class="mxinfo" id="T1:U903"><span class="mxinfo" id="T1:U904"><span class="mxinfo" id="T1:U905">-<span class="var type1" id="S16T1U1444">k_CN</span></span>*<span class="var type1" id="S76T1U1445">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U908"><span class="mxinfo" id="T1:U909"><span class="mxinfo" id="T1:U910">1</span>/(<span class="mxinfo" id="T1:U911"><span class="mxinfo" id="T1:U912">0.56</span> + <span class="mxinfo" id="T1:U913"><span class="mxinfo" id="T1:U914">0.44</span>*<span class="mxinfo" id="T1:U915">sin(<span class="mxinfo" id="T1:U916">abs(<span class="var type1" id="S55T1U1459">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U918"><span class="mxinfo" id="T1:U919">0.41</span>*(<span class="mxinfo" id="T1:U920"><span class="mxinfo" id="T1:U921">1</span>-<span class="mxinfo" id="T1:U922">exp(<span class="mxinfo" id="T1:U923"><span class="mxinfo" id="T1:U924">-17</span>/<span class="var type1" id="S12T1U1470">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U926">sin(<span class="mxinfo" id="T1:U927">abs(<span class="var type1" id="S55T1U1475">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,188" id="srcline188">188</a></span><span class="line">        <span class="mxinfo" id="T1:U929"><span class="var type1" id="S80T1U1478">CT2</span> = <span class="mxinfo" id="T1:U931"><span class="mxinfo" id="T1:U932"><span class="mxinfo" id="T1:U933">0.5</span>*<span class="var type1" id="S13T1U1482">Cd0</span></span>*<span class="mxinfo" id="T1:U935">cos(<span class="var type1" id="S55T1U1485">a_eff</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,189" id="srcline189">189</a></span><span class="line">        <span class="mxinfo" id="T1:U937"><span class="var type1" id="S81T1U1488">CL2</span> = <span class="mxinfo" id="T1:U939"><span class="mxinfo" id="T1:U940"><span class="var type1" id="S78T1U1491">CN2</span>*<span class="mxinfo" id="T1:U942">cos(<span class="var type1" id="S55T1U1494">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U944"><span class="var type1" id="S80T1U1496">CT2</span>*<span class="mxinfo" id="T1:U946">sin(<span class="var type1" id="S55T1U1499">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,190" id="srcline190">190</a></span><span class="line">        <span class="mxinfo" id="T1:U948"><span class="var type1" id="S82T1U1502">CD2</span> = <span class="mxinfo" id="T1:U950"><span class="mxinfo" id="T1:U951"><span class="var type1" id="S78T1U1505">CN2</span>*<span class="mxinfo" id="T1:U953">sin(<span class="var type1" id="S55T1U1508">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U955"><span class="var type1" id="S80T1U1510">CT2</span>*<span class="mxinfo" id="T1:U957">cos(<span class="var type1" id="S55T1U1513">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,191" id="srcline191">191</a></span><span class="line">        <span class="mxinfo" id="T1:U959"><span class="var type1" id="S83T1U1516">CM2</span> = <span class="mxinfo" id="T1:U961"><span class="mxinfo" id="T1:U962">-(<span class="mxinfo" id="T1:U963"><span class="mxinfo" id="T1:U964">0.25</span>-<span class="mxinfo" id="T1:U965"><span class="mxinfo" id="T1:U966">0.175</span>*(<span class="mxinfo" id="T1:U967"><span class="mxinfo" id="T1:U968">1</span>-<span class="mxinfo" id="T1:U969"><span class="mxinfo" id="T1:U970">abs(<span class="var type1" id="S55T1U1530">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U972">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S78T1U1536">CN2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,192" id="srcline192">192</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,193" id="srcline193">193</a></span><span class="line">        <span class="comment">% Interpolation</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,194" id="srcline194">194</a></span><span class="line">        <span class="mxinfo" id="T1:U974"><span class="var type1" id="S2T1U1539">CN</span> = <span class="mxinfo" id="T1:U976">interp1(<span class="mxinfo" id="T23:U977">[<span class="var type1" id="S36T1U1544">LowAlpStart_N</span>,<span class="var type1" id="S40T1U1545">HighAlpEnd_N</span>]</span>,<span class="mxinfo" id="T23:U980">[<span class="var type1" id="S74T1U1548">CN1</span>,<span class="var type1" id="S78T1U1549">CN2</span>]</span>,<span class="var type1" id="S8T1U1550">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,195" id="srcline195">195</a></span><span class="line">        <span class="mxinfo" id="T1:U984"><span class="var type1" id="S3T1U1553">CL</span> = <span class="mxinfo" id="T1:U986">interp1(<span class="mxinfo" id="T23:U987">[<span class="var type1" id="S36T1U1558">LowAlpStart_N</span>,<span class="var type1" id="S40T1U1559">HighAlpEnd_N</span>]</span>,<span class="mxinfo" id="T23:U990">[<span class="var type1" id="S72T1U1562">CL1</span>,<span class="var type1" id="S81T1U1563">CL2</span>]</span>,<span class="var type1" id="S8T1U1564">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,196" id="srcline196">196</a></span><span class="line">        <span class="mxinfo" id="T1:U994"><span class="var type1" id="S4T1U1567">CD</span> = <span class="mxinfo" id="T1:U996">interp1(<span class="mxinfo" id="T23:U997">[<span class="var type1" id="S36T1U1572">LowAlpStart_N</span>,<span class="var type1" id="S40T1U1573">HighAlpEnd_N</span>]</span>,<span class="mxinfo" id="T23:U1000">[<span class="var type1" id="S73T1U1576">CD1</span>,<span class="var type1" id="S82T1U1577">CD2</span>]</span>,<span class="var type1" id="S8T1U1578">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,197" id="srcline197">197</a></span><span class="line">        <span class="mxinfo" id="T1:U1004"><span class="var type1" id="S5T1U1581">CM</span> = <span class="mxinfo" id="T1:U1006">interp1(<span class="mxinfo" id="T23:U1007">[<span class="var type1" id="S36T1U1586">LowAlpStart_N</span>,<span class="var type1" id="S40T1U1587">HighAlpEnd_N</span>]</span>,<span class="mxinfo" id="T23:U1010">[<span class="var type1" id="S75T1U1590">CM1</span>,<span class="var type1" id="S83T1U1591">CM2</span>]</span>,<span class="var type1" id="S8T1U1592">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,198" id="srcline198">198</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,199" id="srcline199">199</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,200" id="srcline200">200</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1014"><span class="var type1" id="S8T1U1596">alp</span> &gt;= <span class="var type1" id="S40T1U1597">HighAlpEnd_N</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1017"><span class="var type1" id="S8T1U1599">alp</span> &lt;= <span class="var type1" id="S39T1U1600">HighAlpStart_N</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,201" id="srcline201">201</a></span><span class="line">        <span class="mxinfo" id="T1:U1020"><span class="var type1" id="S6T1U1603">Reg</span> = <span class="mxinfo" id="T1:U1022">-<span class="mxinfo" id="T1:U1023">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,202" id="srcline202">202</a></span><span class="line">        <span class="comment">% Equivalent flat plate</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,203" id="srcline203">203</a></span><span class="line">        <span class="mxinfo" id="T1:U1024"><span class="var type1" id="S55T1U1608">a_eff</span> = <span class="mxinfo" id="T1:U1026"><span class="var type1" id="S8T1U1610">alp</span> + <span class="var type1" id="S42T1U1611">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,204" id="srcline204">204</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,205" id="srcline205">205</a></span><span class="line">        <span class="comment">% Determining effective Cd90</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,206" id="srcline206">206</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U1029"><span class="mxinfo" id="T1:U1030"><span class="var type1" id="S9T1U1617">cf</span>/<span class="var type1" id="S10T1U1618">c</span></span> == <span class="mxinfo" id="T1:U1033">1</span></span> || <span class="mxinfo" id="T4:U1034"><span class="mxinfo" id="T1:U1035"><span class="var type1" id="S9T1U1622">cf</span>/<span class="var type1" id="S10T1U1623">c</span></span> == <span class="mxinfo" id="T1:U1038">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,207" id="srcline207">207</a></span><span class="line">            <span class="mxinfo" id="T1:U1039"><span class="var type1" id="S76T1U1627">Cd90_eff</span> = <span class="var type1" id="S14T1U1628">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,208" id="srcline208">208</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1042"><span class="mxinfo" id="T1:U1043">sign(<span class="var type1" id="S8T1U1633">alp</span>)</span> == <span class="mxinfo" id="T1:U1045">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,209" id="srcline209">209</a></span><span class="line">            <span class="mxinfo" id="T1:U1046"><span class="var type1" id="S76T1U1637">Cd90_eff</span> = <span class="mxinfo" id="T1:U1048"><span class="mxinfo" id="T1:U1049"><span class="mxinfo" id="T1:U1050"><span class="mxinfo" id="T1:U1051">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1052">(<span class="mxinfo" id="T1:U1053"><span class="mxinfo" id="T1:U1054"><span class="var type1" id="S11T1U1647">def</span>*<span class="mxinfo" id="T1:U1056">180</span></span>/<span class="mxinfo" id="T1:U1057">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U1058"><span class="mxinfo" id="T1:U1059">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1060"><span class="mxinfo" id="T1:U1061"><span class="var type1" id="S11T1U1657">def</span>*<span class="mxinfo" id="T1:U1063">180</span></span>/<span class="mxinfo" id="T1:U1064">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1661">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,210" id="srcline210">210</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,211" id="srcline211">211</a></span><span class="line">            <span class="mxinfo" id="T1:U1066"><span class="var type1" id="S76T1U1665">Cd90_eff</span> = <span class="mxinfo" id="T1:U1068"><span class="mxinfo" id="T1:U1069"><span class="mxinfo" id="T1:U1070"><span class="mxinfo" id="T1:U1071">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1072">(<span class="mxinfo" id="T1:U1073"><span class="mxinfo" id="T1:U1074"><span class="var type1" id="S11T1U1675">def</span>*<span class="mxinfo" id="T1:U1076">180</span></span>/<span class="mxinfo" id="T1:U1077">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U1078"><span class="mxinfo" id="T1:U1079">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1080"><span class="mxinfo" id="T1:U1081"><span class="var type1" id="S11T1U1685">def</span>*<span class="mxinfo" id="T1:U1083">180</span></span>/<span class="mxinfo" id="T1:U1084">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1689">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,212" id="srcline212">212</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,213" id="srcline213">213</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,214" id="srcline214">214</a></span><span class="line">        <span class="comment">% Hoerner Model</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,215" id="srcline215">215</a></span><span class="line">        <span class="mxinfo" id="T1:U1086"><span class="var type1" id="S2T1U1692">CN</span> = <span class="mxinfo" id="T1:U1088"><span class="mxinfo" id="T1:U1089"><span class="mxinfo" id="T1:U1090"><span class="mxinfo" id="T1:U1091">-<span class="var type1" id="S16T1U1697">k_CN</span></span>*<span class="var type1" id="S76T1U1698">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U1094"><span class="mxinfo" id="T1:U1095"><span class="mxinfo" id="T1:U1096">1</span>/(<span class="mxinfo" id="T1:U1097"><span class="mxinfo" id="T1:U1098">0.56</span> + <span class="mxinfo" id="T1:U1099"><span class="mxinfo" id="T1:U1100">0.44</span>*<span class="mxinfo" id="T1:U1101">sin(<span class="mxinfo" id="T1:U1102">abs(<span class="var type1" id="S55T1U1712">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U1104"><span class="mxinfo" id="T1:U1105">0.41</span>*(<span class="mxinfo" id="T1:U1106"><span class="mxinfo" id="T1:U1107">1</span>-<span class="mxinfo" id="T1:U1108">exp(<span class="mxinfo" id="T1:U1109"><span class="mxinfo" id="T1:U1110">-17</span>/<span class="var type1" id="S12T1U1723">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U1112">sin(<span class="mxinfo" id="T1:U1113">abs(<span class="var type1" id="S55T1U1728">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,216" id="srcline216">216</a></span><span class="line">        <span class="mxinfo" id="T1:U1115"><span class="var type1" id="S84T1U1731">CT</span> = <span class="mxinfo" id="T1:U1117"><span class="mxinfo" id="T1:U1118"><span class="mxinfo" id="T1:U1119">0.5</span>*<span class="var type1" id="S13T1U1735">Cd0</span></span>*<span class="mxinfo" id="T1:U1121">cos(<span class="var type1" id="S55T1U1738">a_eff</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,217" id="srcline217">217</a></span><span class="line">        <span class="mxinfo" id="T1:U1123"><span class="var type1" id="S3T1U1741">CL</span> = <span class="mxinfo" id="T1:U1125"><span class="mxinfo" id="T1:U1126"><span class="var type1" id="S2T1U1744">CN</span>*<span class="mxinfo" id="T1:U1128">cos(<span class="var type1" id="S55T1U1747">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U1130"><span class="var type1" id="S84T1U1749">CT</span>*<span class="mxinfo" id="T1:U1132">sin(<span class="var type1" id="S55T1U1752">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,218" id="srcline218">218</a></span><span class="line">        <span class="mxinfo" id="T1:U1134"><span class="var type1" id="S4T1U1755">CD</span> = <span class="mxinfo" id="T1:U1136"><span class="mxinfo" id="T1:U1137"><span class="var type1" id="S2T1U1758">CN</span>*<span class="mxinfo" id="T1:U1139">sin(<span class="var type1" id="S55T1U1761">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1141"><span class="var type1" id="S84T1U1763">CT</span>*<span class="mxinfo" id="T1:U1143">cos(<span class="var type1" id="S55T1U1766">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,219" id="srcline219">219</a></span><span class="line">        <span class="mxinfo" id="T1:U1145"><span class="var type1" id="S5T1U1769">CM</span> = <span class="mxinfo" id="T1:U1147"><span class="mxinfo" id="T1:U1148">-(<span class="mxinfo" id="T1:U1149"><span class="mxinfo" id="T1:U1150">0.25</span>-<span class="mxinfo" id="T1:U1151"><span class="mxinfo" id="T1:U1152">0.175</span>*(<span class="mxinfo" id="T1:U1153"><span class="mxinfo" id="T1:U1154">1</span>-<span class="mxinfo" id="T1:U1155"><span class="mxinfo" id="T1:U1156">abs(<span class="var type1" id="S55T1U1783">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U1158">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S2T1U1789">CN</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="100,220" id="srcline220">220</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,221" id="srcline221">221</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,222" id="srcline222">222</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1160"><span class="var type1" id="S8T1U1793">alp</span> &gt; <span class="var type1" id="S39T1U1794">HighAlpStart_N</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1163"><span class="var type1" id="S8T1U1796">alp</span> &lt; <span class="var type1" id="S34T1U1797">LowAlpEnd_N</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,223" id="srcline223">223</a></span><span class="line">        <span class="mxinfo" id="T1:U1166"><span class="var type1" id="S6T1U1800">Reg</span> = <span class="mxinfo" id="T1:U1168">-<span class="mxinfo" id="T1:U1169">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,224" id="srcline224">224</a></span><span class="line">        <span class="comment">% Linear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,225" id="srcline225">225</a></span><span class="line">        <span class="mxinfo" id="T1:U1170"><span class="var type1" id="S55T1U1805">a_eff</span> = <span class="mxinfo" id="T1:U1172"><span class="var type1" id="S34T1U1807">LowAlpEnd_N</span> - <span class="var type1" id="S32T1U1808">alp0_eff</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,226" id="srcline226">226</a></span><span class="line">        <span class="mxinfo" id="T1:U1175"><span class="var type1" id="S72T1U1811">CL1</span> = <span class="mxinfo" id="T1:U1177"><span class="mxinfo" id="T1:U1178"><span class="mxinfo" id="T1:U1179"><span class="var type1" id="S30T1U1815">Kp</span>*<span class="mxinfo" id="T1:U1181">sin(<span class="var type1" id="S55T1U1818">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1183">(<span class="mxinfo" id="T1:U1184">cos(<span class="var type1" id="S55T1U1823">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U1186"><span class="mxinfo" id="T1:U1187"><span class="mxinfo" id="T1:U1188"><span class="mxinfo" id="T1:U1189"><span class="var type1" id="S31T1U1828">Kv</span></span>*<span class="mxinfo" id="T1:U1191">abs(<span class="mxinfo" id="T1:U1192">sin(<span class="var type1" id="S55T1U1833">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1194">sin(<span class="var type1" id="S55T1U1836">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1196">cos(<span class="var type1" id="S55T1U1839">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,227" id="srcline227">227</a></span><span class="line">        <span class="mxinfo" id="T1:U1198"><span class="var type1" id="S73T1U1842">CD1</span> = <span class="mxinfo" id="T1:U1200"><span class="var type1" id="S13T1U1844">Cd0</span> + <span class="mxinfo" id="T1:U1202">abs(<span class="mxinfo" id="T1:U1203"><span class="mxinfo" id="T1:U1204"><span class="mxinfo" id="T1:U1205"><span class="mxinfo" id="T1:U1206"><span class="var type1" id="S30T1U1851">Kp</span>*<span class="mxinfo" id="T1:U1208">abs(<span class="mxinfo" id="T1:U1209">sin(<span class="var type1" id="S55T1U1856">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1211">sin(<span class="var type1" id="S55T1U1859">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1213">cos(<span class="var type1" id="S55T1U1862">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1215"><span class="mxinfo" id="T1:U1216"><span class="var type1" id="S31T1U1864">Kv</span></span>*<span class="mxinfo" id="T1:U1218">(<span class="mxinfo" id="T1:U1219">sin(<span class="var type1" id="S55T1U1869">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,228" id="srcline228">228</a></span><span class="line">        <span class="mxinfo" id="T1:U1221"><span class="var type1" id="S74T1U1873">CN1</span> = <span class="mxinfo" id="T1:U1223"><span class="mxinfo" id="T1:U1224"><span class="mxinfo" id="T1:U1225"><span class="var type1" id="S30T1U1877">Kp</span>*<span class="mxinfo" id="T1:U1227">sin(<span class="var type1" id="S55T1U1880">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1229">cos(<span class="var type1" id="S55T1U1883">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1231"><span class="mxinfo" id="T1:U1232"><span class="mxinfo" id="T1:U1233"><span class="var type1" id="S31T1U1886">Kv</span></span>*<span class="mxinfo" id="T1:U1235">abs(<span class="mxinfo" id="T1:U1236">sin(<span class="var type1" id="S55T1U1891">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1238">sin(<span class="var type1" id="S55T1U1894">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,229" id="srcline229">229</a></span><span class="line">        <span class="mxinfo" id="T1:U1240"><span class="var type1" id="S75T1U1897">CM1</span> = <span class="mxinfo" id="T1:U1242"><span class="mxinfo" id="T1:U1243"><span class="mxinfo" id="T1:U1244">-(0.42-0.25)*<span class="var type1" id="S31T1U1906">Kv</span></span>*<span class="mxinfo" id="T1:U1246">abs(<span class="mxinfo" id="T1:U1247">sin(<span class="var type1" id="S55T1U1911">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1249">sin(<span class="var type1" id="S55T1U1914">a_eff</span>)</span></span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="100,230" id="srcline230">230</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,231" id="srcline231">231</a></span><span class="line">        <span class="comment">% NonLinear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,232" id="srcline232">232</a></span><span class="line">        <span class="mxinfo" id="T1:U1251"><span class="var type1" id="S55T1U1917">a_eff</span> = <span class="mxinfo" id="T1:U1253"><span class="var type1" id="S39T1U1919">HighAlpStart_N</span> + <span class="var type1" id="S42T1U1920">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,233" id="srcline233">233</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,234" id="srcline234">234</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U1256"><span class="mxinfo" id="T1:U1257"><span class="var type1" id="S9T1U1926">cf</span>/<span class="var type1" id="S10T1U1927">c</span></span> == <span class="mxinfo" id="T1:U1260">1</span></span> || <span class="mxinfo" id="T4:U1261"><span class="mxinfo" id="T1:U1262"><span class="var type1" id="S9T1U1931">cf</span>/<span class="var type1" id="S10T1U1932">c</span></span> == <span class="mxinfo" id="T1:U1265">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,235" id="srcline235">235</a></span><span class="line">            <span class="mxinfo" id="T1:U1266"><span class="var type1" id="S76T1U1936">Cd90_eff</span> = <span class="var type1" id="S14T1U1937">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,236" id="srcline236">236</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1269"><span class="mxinfo" id="T1:U1270">sign(<span class="var type1" id="S39T1U1942">HighAlpStart_N</span>)</span> == <span class="mxinfo" id="T1:U1272">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,237" id="srcline237">237</a></span><span class="line">            <span class="mxinfo" id="T1:U1273"><span class="var type1" id="S76T1U1946">Cd90_eff</span> = <span class="mxinfo" id="T1:U1275"><span class="mxinfo" id="T1:U1276"><span class="mxinfo" id="T1:U1277"><span class="mxinfo" id="T1:U1278">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1279">(<span class="mxinfo" id="T1:U1280"><span class="mxinfo" id="T1:U1281"><span class="var type1" id="S11T1U1956">def</span>*<span class="mxinfo" id="T1:U1283">180</span></span>/<span class="mxinfo" id="T1:U1284">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U1285"><span class="mxinfo" id="T1:U1286">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1287"><span class="mxinfo" id="T1:U1288"><span class="var type1" id="S11T1U1966">def</span>*<span class="mxinfo" id="T1:U1290">180</span></span>/<span class="mxinfo" id="T1:U1291">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1970">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,238" id="srcline238">238</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,239" id="srcline239">239</a></span><span class="line">            <span class="mxinfo" id="T1:U1293"><span class="var type1" id="S76T1U1974">Cd90_eff</span> = <span class="mxinfo" id="T1:U1295"><span class="mxinfo" id="T1:U1296"><span class="mxinfo" id="T1:U1297"><span class="mxinfo" id="T1:U1298">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1299">(<span class="mxinfo" id="T1:U1300"><span class="mxinfo" id="T1:U1301"><span class="var type1" id="S11T1U1984">def</span>*<span class="mxinfo" id="T1:U1303">180</span></span>/<span class="mxinfo" id="T1:U1304">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U1305"><span class="mxinfo" id="T1:U1306">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1307"><span class="mxinfo" id="T1:U1308"><span class="var type1" id="S11T1U1994">def</span>*<span class="mxinfo" id="T1:U1310">180</span></span>/<span class="mxinfo" id="T1:U1311">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U1998">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,240" id="srcline240">240</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,241" id="srcline241">241</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,242" id="srcline242">242</a></span><span class="line">        <span class="mxinfo" id="T1:U1313"><span class="var type1" id="S78T1U2001">CN2</span> = <span class="mxinfo" id="T1:U1315"><span class="mxinfo" id="T1:U1316"><span class="mxinfo" id="T1:U1317"><span class="mxinfo" id="T1:U1318">-<span class="var type1" id="S16T1U2006">k_CN</span></span>*<span class="var type1" id="S76T1U2007">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U1321"><span class="mxinfo" id="T1:U1322"><span class="mxinfo" id="T1:U1323">1</span>/(<span class="mxinfo" id="T1:U1324"><span class="mxinfo" id="T1:U1325">0.56</span> + <span class="mxinfo" id="T1:U1326"><span class="mxinfo" id="T1:U1327">0.44</span>*<span class="mxinfo" id="T1:U1328">sin(<span class="mxinfo" id="T1:U1329">abs(<span class="var type1" id="S55T1U2021">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U1331"><span class="mxinfo" id="T1:U1332">0.41</span>*(<span class="mxinfo" id="T1:U1333"><span class="mxinfo" id="T1:U1334">1</span>-<span class="mxinfo" id="T1:U1335">exp(<span class="mxinfo" id="T1:U1336"><span class="mxinfo" id="T1:U1337">-17</span>/<span class="var type1" id="S12T1U2032">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U1339">sin(<span class="mxinfo" id="T1:U1340">abs(<span class="var type1" id="S55T1U2037">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,243" id="srcline243">243</a></span><span class="line">        <span class="mxinfo" id="T1:U1342"><span class="var type1" id="S80T1U2040">CT2</span> = <span class="mxinfo" id="T1:U1344"><span class="mxinfo" id="T1:U1345"><span class="mxinfo" id="T1:U1346">0.5</span>*<span class="var type1" id="S13T1U2044">Cd0</span></span>*<span class="mxinfo" id="T1:U1348">cos(<span class="var type1" id="S55T1U2047">a_eff</span>)</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="100,244" id="srcline244">244</a></span><span class="line">        <span class="mxinfo" id="T1:U1350"><span class="var type1" id="S81T1U2050">CL2</span> = <span class="mxinfo" id="T1:U1352"><span class="mxinfo" id="T1:U1353"><span class="var type1" id="S78T1U2053">CN2</span>*<span class="mxinfo" id="T1:U1355">cos(<span class="var type1" id="S55T1U2056">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U1357"><span class="var type1" id="S80T1U2058">CT2</span>*<span class="mxinfo" id="T1:U1359">sin(<span class="var type1" id="S55T1U2061">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,245" id="srcline245">245</a></span><span class="line">        <span class="mxinfo" id="T1:U1361"><span class="var type1" id="S82T1U2064">CD2</span> = <span class="mxinfo" id="T1:U1363"><span class="mxinfo" id="T1:U1364"><span class="var type1" id="S78T1U2067">CN2</span>*<span class="mxinfo" id="T1:U1366">sin(<span class="var type1" id="S55T1U2070">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1368"><span class="var type1" id="S80T1U2072">CT2</span>*<span class="mxinfo" id="T1:U1370">cos(<span class="var type1" id="S55T1U2075">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,246" id="srcline246">246</a></span><span class="line">        <span class="mxinfo" id="T1:U1372"><span class="var type1" id="S83T1U2078">CM2</span> = <span class="mxinfo" id="T1:U1374"><span class="mxinfo" id="T1:U1375">-(<span class="mxinfo" id="T1:U1376"><span class="mxinfo" id="T1:U1377">0.25</span>-<span class="mxinfo" id="T1:U1378"><span class="mxinfo" id="T1:U1379">0.175</span>*(<span class="mxinfo" id="T1:U1380"><span class="mxinfo" id="T1:U1381">1</span>-<span class="mxinfo" id="T1:U1382"><span class="mxinfo" id="T1:U1383">abs(<span class="var type1" id="S55T1U2092">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U1385">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S78T1U2098">CN2</span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,247" id="srcline247">247</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,248" id="srcline248">248</a></span><span class="line">        <span class="comment">% Interpolation</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,249" id="srcline249">249</a></span><span class="line">        <span class="mxinfo" id="T1:U1387"><span class="var type1" id="S2T1U2101">CN</span> = <span class="mxinfo" id="T1:U1389">interp1(<span class="mxinfo" id="T23:U1390">[<span class="var type1" id="S34T1U2106">LowAlpEnd_N</span>,<span class="var type1" id="S39T1U2107">HighAlpStart_N</span>]</span>,<span class="mxinfo" id="T23:U1393">[<span class="var type1" id="S74T1U2110">CN1</span>,<span class="var type1" id="S78T1U2111">CN2</span>]</span>,<span class="var type1" id="S8T1U2112">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,250" id="srcline250">250</a></span><span class="line">        <span class="mxinfo" id="T1:U1397"><span class="var type1" id="S3T1U2115">CL</span> = <span class="mxinfo" id="T1:U1399">interp1(<span class="mxinfo" id="T23:U1400">[<span class="var type1" id="S34T1U2120">LowAlpEnd_N</span>,<span class="var type1" id="S39T1U2121">HighAlpStart_N</span>]</span>,<span class="mxinfo" id="T23:U1403">[<span class="var type1" id="S72T1U2124">CL1</span>,<span class="var type1" id="S81T1U2125">CL2</span>]</span>,<span class="var type1" id="S8T1U2126">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,251" id="srcline251">251</a></span><span class="line">        <span class="mxinfo" id="T1:U1407"><span class="var type1" id="S4T1U2129">CD</span> = <span class="mxinfo" id="T1:U1409">interp1(<span class="mxinfo" id="T23:U1410">[<span class="var type1" id="S34T1U2134">LowAlpEnd_N</span>,<span class="var type1" id="S39T1U2135">HighAlpStart_N</span>]</span>,<span class="mxinfo" id="T23:U1413">[<span class="var type1" id="S73T1U2138">CD1</span>,<span class="var type1" id="S82T1U2139">CD2</span>]</span>,<span class="var type1" id="S8T1U2140">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,252" id="srcline252">252</a></span><span class="line">        <span class="mxinfo" id="T1:U1417"><span class="var type1" id="S5T1U2143">CM</span> = <span class="mxinfo" id="T1:U1419">interp1(<span class="mxinfo" id="T23:U1420">[<span class="var type1" id="S34T1U2148">LowAlpEnd_N</span>,<span class="var type1" id="S39T1U2149">HighAlpStart_N</span>]</span>,<span class="mxinfo" id="T23:U1423">[<span class="var type1" id="S75T1U2152">CM1</span>,<span class="var type1" id="S83T1U2153">CM2</span>]</span>,<span class="var type1" id="S8T1U2154">alp</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="100,253" id="srcline253">253</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,254" id="srcline254">254</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %        </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,255" id="srcline255">255</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1427"><span class="var type1" id="S8T1U2158">alp</span> &gt;= <span class="var type1" id="S34T1U2159">LowAlpEnd_N</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1430"><span class="var type1" id="S8T1U2161">alp</span> &lt;= <span class="var type1" id="S33T1U2162">LowAlpEnd_P</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,256" id="srcline256">256</a></span><span class="line">        <span class="mxinfo" id="T1:U1433"><span class="var type1" id="S6T1U2165">Reg</span> = <span class="mxinfo" id="T1:U1435">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,257" id="srcline257">257</a></span><span class="line">        <span class="mxinfo" id="T1:U1436"><span class="var type1" id="S55T1U2169">a_eff</span> = <span class="mxinfo" id="T1:U1438"><span class="var type1" id="S8T1U2171">alp</span> - <span class="var type1" id="S32T1U2172">alp0_eff</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,258" id="srcline258">258</a></span><span class="line">        <span class="mxinfo" id="T1:U1441"><span class="var type1" id="S3T1U2175">CL</span> = <span class="mxinfo" id="T1:U1443"><span class="mxinfo" id="T1:U1444"><span class="mxinfo" id="T1:U1445"><span class="var type1" id="S30T1U2179">Kp</span>*<span class="mxinfo" id="T1:U1447">sin(<span class="var type1" id="S55T1U2182">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1449">(<span class="mxinfo" id="T1:U1450">cos(<span class="var type1" id="S55T1U2187">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U1452"><span class="mxinfo" id="T1:U1453"><span class="mxinfo" id="T1:U1454"><span class="mxinfo" id="T1:U1455"><span class="var type1" id="S31T1U2192">Kv</span></span>*<span class="mxinfo" id="T1:U1457">abs(<span class="mxinfo" id="T1:U1458">sin(<span class="var type1" id="S55T1U2197">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1460">sin(<span class="var type1" id="S55T1U2200">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1462">cos(<span class="var type1" id="S55T1U2203">a_eff</span>)</span></span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,259" id="srcline259">259</a></span><span class="line">        <span class="mxinfo" id="T1:U1464"><span class="var type1" id="S4T1U2206">CD</span> = <span class="mxinfo" id="T1:U1466"><span class="mxinfo" id="T1:U1467"><span class="var type1" id="S13T1U2209">Cd0</span> + <span class="mxinfo" id="T1:U1469">abs(<span class="mxinfo" id="T1:U1470"><span class="mxinfo" id="T1:U1471"><span class="mxinfo" id="T1:U1472"><span class="var type1" id="S30T1U2215">Kp</span>*<span class="mxinfo" id="T1:U1474">abs(<span class="mxinfo" id="T1:U1475">sin(<span class="var type1" id="S55T1U2220">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1477">sin(<span class="var type1" id="S55T1U2223">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1479">cos(<span class="var type1" id="S55T1U2226">a_eff</span>)</span></span>)</span></span> + <span class="mxinfo" id="T1:U1481"><span class="mxinfo" id="T1:U1482"><span class="var type1" id="S31T1U2228">Kv</span></span>*<span class="mxinfo" id="T1:U1484">abs(<span class="mxinfo" id="T1:U1485">(<span class="mxinfo" id="T1:U1486">sin(<span class="var type1" id="S55T1U2235">a_eff</span>)</span>)^3</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,260" id="srcline260">260</a></span><span class="line">        <span class="mxinfo" id="T1:U1488"><span class="var type1" id="S2T1U2239">CN</span> = <span class="mxinfo" id="T1:U1490"><span class="mxinfo" id="T1:U1491"><span class="mxinfo" id="T1:U1492"><span class="var type1" id="S30T1U2243">Kp</span>*<span class="mxinfo" id="T1:U1494">sin(<span class="var type1" id="S55T1U2246">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1496">cos(<span class="var type1" id="S55T1U2249">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1498"><span class="mxinfo" id="T1:U1499"><span class="mxinfo" id="T1:U1500"><span class="var type1" id="S31T1U2252">Kv</span></span>*<span class="mxinfo" id="T1:U1502">abs(<span class="mxinfo" id="T1:U1503">sin(<span class="var type1" id="S55T1U2257">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1505">sin(<span class="var type1" id="S55T1U2260">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,261" id="srcline261">261</a></span><span class="line">        <span class="mxinfo" id="T1:U1507"><span class="var type1" id="S5T1U2263">CM</span> = <span class="mxinfo" id="T1:U1509"><span class="mxinfo" id="T1:U1510"><span class="mxinfo" id="T1:U1511">-(0.42-0.25)*<span class="var type1" id="S31T1U2272">Kv</span></span>*<span class="mxinfo" id="T1:U1513">abs(<span class="mxinfo" id="T1:U1514">sin(<span class="var type1" id="S55T1U2277">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1516">sin(<span class="var type1" id="S55T1U2280">a_eff</span>)</span></span></span>;                    </span></span>
<span class="srcline"><span class="lineno"><a href="100,262" id="srcline262">262</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,263" id="srcline263">263</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %              </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,264" id="srcline264">264</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1518"><span class="var type1" id="S8T1U2284">alp</span> &gt; <span class="var type1" id="S33T1U2285">LowAlpEnd_P</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1521"><span class="var type1" id="S8T1U2287">alp</span> &lt; <span class="var type1" id="S37T1U2288">HighAlpStart_P</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,265" id="srcline265">265</a></span><span class="line">        <span class="mxinfo" id="T1:U1524"><span class="var type1" id="S6T1U2291">Reg</span> = <span class="mxinfo" id="T1:U1526">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,266" id="srcline266">266</a></span><span class="line">        <span class="comment">% Linear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,267" id="srcline267">267</a></span><span class="line">        <span class="mxinfo" id="T1:U1527"><span class="var type1" id="S55T1U2295">a_eff</span> = <span class="mxinfo" id="T1:U1529"><span class="var type1" id="S33T1U2297">LowAlpEnd_P</span> - <span class="var type1" id="S32T1U2298">alp0_eff</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,268" id="srcline268">268</a></span><span class="line">        <span class="mxinfo" id="T1:U1532"><span class="var type1" id="S72T1U2301">CL1</span> = <span class="mxinfo" id="T1:U1534"><span class="mxinfo" id="T1:U1535"><span class="mxinfo" id="T1:U1536"><span class="var type1" id="S30T1U2305">Kp</span>*<span class="mxinfo" id="T1:U1538">sin(<span class="var type1" id="S55T1U2308">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1540">(<span class="mxinfo" id="T1:U1541">cos(<span class="var type1" id="S55T1U2313">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U1543"><span class="mxinfo" id="T1:U1544"><span class="mxinfo" id="T1:U1545"><span class="mxinfo" id="T1:U1546"><span class="var type1" id="S31T1U2318">Kv</span></span>*<span class="mxinfo" id="T1:U1548">abs(<span class="mxinfo" id="T1:U1549">sin(<span class="var type1" id="S55T1U2323">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1551">sin(<span class="var type1" id="S55T1U2326">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1553">cos(<span class="var type1" id="S55T1U2329">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,269" id="srcline269">269</a></span><span class="line">        <span class="mxinfo" id="T1:U1555"><span class="var type1" id="S73T1U2332">CD1</span> = <span class="mxinfo" id="T1:U1557"><span class="var type1" id="S13T1U2334">Cd0</span> + <span class="mxinfo" id="T1:U1559">abs(<span class="mxinfo" id="T1:U1560"><span class="mxinfo" id="T1:U1561"><span class="mxinfo" id="T1:U1562"><span class="mxinfo" id="T1:U1563"><span class="var type1" id="S30T1U2341">Kp</span>*<span class="mxinfo" id="T1:U1565">abs(<span class="mxinfo" id="T1:U1566">sin(<span class="var type1" id="S55T1U2346">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1568">sin(<span class="var type1" id="S55T1U2349">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1570">cos(<span class="var type1" id="S55T1U2352">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1572"><span class="mxinfo" id="T1:U1573"><span class="var type1" id="S31T1U2354">Kv</span></span>*<span class="mxinfo" id="T1:U1575">(<span class="mxinfo" id="T1:U1576">sin(<span class="var type1" id="S55T1U2359">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,270" id="srcline270">270</a></span><span class="line">        <span class="mxinfo" id="T1:U1578"><span class="var type1" id="S74T1U2363">CN1</span> = <span class="mxinfo" id="T1:U1580"><span class="mxinfo" id="T1:U1581"><span class="mxinfo" id="T1:U1582"><span class="var type1" id="S30T1U2367">Kp</span>*<span class="mxinfo" id="T1:U1584">sin(<span class="var type1" id="S55T1U2370">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1586">cos(<span class="var type1" id="S55T1U2373">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1588"><span class="mxinfo" id="T1:U1589"><span class="mxinfo" id="T1:U1590"><span class="var type1" id="S31T1U2376">Kv</span></span>*<span class="mxinfo" id="T1:U1592">abs(<span class="mxinfo" id="T1:U1593">sin(<span class="var type1" id="S55T1U2381">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1595">sin(<span class="var type1" id="S55T1U2384">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,271" id="srcline271">271</a></span><span class="line">        <span class="mxinfo" id="T1:U1597"><span class="var type1" id="S75T1U2387">CM1</span> = <span class="mxinfo" id="T1:U1599"><span class="mxinfo" id="T1:U1600"><span class="mxinfo" id="T1:U1601">-(0.42-0.25)*<span class="var type1" id="S31T1U2396">Kv</span></span>*<span class="mxinfo" id="T1:U1603">abs(<span class="mxinfo" id="T1:U1604">sin(<span class="var type1" id="S55T1U2401">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1606">sin(<span class="var type1" id="S55T1U2404">a_eff</span>)</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="100,272" id="srcline272">272</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="100,273" id="srcline273">273</a></span><span class="line">        <span class="comment">% NonLinear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,274" id="srcline274">274</a></span><span class="line">        <span class="mxinfo" id="T1:U1608"><span class="var type1" id="S55T1U2407">a_eff</span> = <span class="mxinfo" id="T1:U1610"><span class="var type1" id="S37T1U2409">HighAlpStart_P</span> + <span class="var type1" id="S42T1U2410">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,275" id="srcline275">275</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,276" id="srcline276">276</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U1613"><span class="mxinfo" id="T1:U1614"><span class="var type1" id="S9T1U2416">cf</span>/<span class="var type1" id="S10T1U2417">c</span></span> == <span class="mxinfo" id="T1:U1617">1</span></span> || <span class="mxinfo" id="T4:U1618"><span class="mxinfo" id="T1:U1619"><span class="var type1" id="S9T1U2421">cf</span>/<span class="var type1" id="S10T1U2422">c</span></span> == <span class="mxinfo" id="T1:U1622">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,277" id="srcline277">277</a></span><span class="line">            <span class="mxinfo" id="T1:U1623"><span class="var type1" id="S76T1U2426">Cd90_eff</span> = <span class="var type1" id="S14T1U2427">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,278" id="srcline278">278</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1626"><span class="mxinfo" id="T1:U1627">sign(<span class="var type1" id="S37T1U2432">HighAlpStart_P</span>)</span> == <span class="mxinfo" id="T1:U1629">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,279" id="srcline279">279</a></span><span class="line">            <span class="mxinfo" id="T1:U1630"><span class="var type1" id="S76T1U2436">Cd90_eff</span> = <span class="mxinfo" id="T1:U1632"><span class="mxinfo" id="T1:U1633"><span class="mxinfo" id="T1:U1634"><span class="mxinfo" id="T1:U1635">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1636">(<span class="mxinfo" id="T1:U1637"><span class="mxinfo" id="T1:U1638"><span class="var type1" id="S11T1U2446">def</span>*<span class="mxinfo" id="T1:U1640">180</span></span>/<span class="mxinfo" id="T1:U1641">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U1642"><span class="mxinfo" id="T1:U1643">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1644"><span class="mxinfo" id="T1:U1645"><span class="var type1" id="S11T1U2456">def</span>*<span class="mxinfo" id="T1:U1647">180</span></span>/<span class="mxinfo" id="T1:U1648">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U2460">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,280" id="srcline280">280</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,281" id="srcline281">281</a></span><span class="line">            <span class="mxinfo" id="T1:U1650"><span class="var type1" id="S76T1U2464">Cd90_eff</span> = <span class="mxinfo" id="T1:U1652"><span class="mxinfo" id="T1:U1653"><span class="mxinfo" id="T1:U1654"><span class="mxinfo" id="T1:U1655">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1656">(<span class="mxinfo" id="T1:U1657"><span class="mxinfo" id="T1:U1658"><span class="var type1" id="S11T1U2474">def</span>*<span class="mxinfo" id="T1:U1660">180</span></span>/<span class="mxinfo" id="T1:U1661">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U1662"><span class="mxinfo" id="T1:U1663">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1664"><span class="mxinfo" id="T1:U1665"><span class="var type1" id="S11T1U2484">def</span>*<span class="mxinfo" id="T1:U1667">180</span></span>/<span class="mxinfo" id="T1:U1668">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U2488">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,282" id="srcline282">282</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,283" id="srcline283">283</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,284" id="srcline284">284</a></span><span class="line">        <span class="mxinfo" id="T1:U1670"><span class="var type1" id="S78T1U2491">CN2</span> = <span class="mxinfo" id="T1:U1672"><span class="mxinfo" id="T1:U1673"><span class="mxinfo" id="T1:U1674"><span class="mxinfo" id="T1:U1675"><span class="var type1" id="S16T1U2495">k_CN</span></span>*<span class="var type1" id="S76T1U2496">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U1678"><span class="mxinfo" id="T1:U1679"><span class="mxinfo" id="T1:U1680">1</span>/(<span class="mxinfo" id="T1:U1681"><span class="mxinfo" id="T1:U1682">0.56</span> + <span class="mxinfo" id="T1:U1683"><span class="mxinfo" id="T1:U1684">0.44</span>*<span class="mxinfo" id="T1:U1685">sin(<span class="mxinfo" id="T1:U1686">abs(<span class="var type1" id="S55T1U2510">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U1688"><span class="mxinfo" id="T1:U1689">0.41</span>*(<span class="mxinfo" id="T1:U1690"><span class="mxinfo" id="T1:U1691">1</span>-<span class="mxinfo" id="T1:U1692">exp(<span class="mxinfo" id="T1:U1693"><span class="mxinfo" id="T1:U1694">-17</span>/<span class="var type1" id="S12T1U2521">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U1696">sin(<span class="mxinfo" id="T1:U1697">abs(<span class="var type1" id="S55T1U2526">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,285" id="srcline285">285</a></span><span class="line">        <span class="mxinfo" id="T1:U1699"><span class="var type1" id="S80T1U2529">CT2</span> = <span class="mxinfo" id="T1:U1701"><span class="mxinfo" id="T1:U1702"><span class="mxinfo" id="T1:U1703">0.5</span>*<span class="var type1" id="S13T1U2533">Cd0</span></span>*<span class="mxinfo" id="T1:U1705">cos(<span class="var type1" id="S55T1U2536">a_eff</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,286" id="srcline286">286</a></span><span class="line">        <span class="mxinfo" id="T1:U1707"><span class="var type1" id="S81T1U2539">CL2</span> = <span class="mxinfo" id="T1:U1709"><span class="mxinfo" id="T1:U1710"><span class="var type1" id="S78T1U2542">CN2</span>*<span class="mxinfo" id="T1:U1712">cos(<span class="var type1" id="S55T1U2545">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U1714"><span class="var type1" id="S80T1U2547">CT2</span>*<span class="mxinfo" id="T1:U1716">sin(<span class="var type1" id="S55T1U2550">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,287" id="srcline287">287</a></span><span class="line">        <span class="mxinfo" id="T1:U1718"><span class="var type1" id="S82T1U2553">CD2</span> = <span class="mxinfo" id="T1:U1720"><span class="mxinfo" id="T1:U1721"><span class="var type1" id="S78T1U2556">CN2</span>*<span class="mxinfo" id="T1:U1723">sin(<span class="var type1" id="S55T1U2559">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1725"><span class="var type1" id="S80T1U2561">CT2</span>*<span class="mxinfo" id="T1:U1727">cos(<span class="var type1" id="S55T1U2564">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,288" id="srcline288">288</a></span><span class="line">        <span class="mxinfo" id="T1:U1729"><span class="var type1" id="S83T1U2567">CM2</span> = <span class="mxinfo" id="T1:U1731"><span class="mxinfo" id="T1:U1732">-(<span class="mxinfo" id="T1:U1733"><span class="mxinfo" id="T1:U1734">0.25</span>-<span class="mxinfo" id="T1:U1735"><span class="mxinfo" id="T1:U1736">0.175</span>*(<span class="mxinfo" id="T1:U1737"><span class="mxinfo" id="T1:U1738">1</span>-<span class="mxinfo" id="T1:U1739"><span class="mxinfo" id="T1:U1740">abs(<span class="var type1" id="S55T1U2581">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U1742">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S78T1U2587">CN2</span></span></span>;                       </span></span>
<span class="srcline"><span class="lineno"><a href="100,289" id="srcline289">289</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,290" id="srcline290">290</a></span><span class="line">        <span class="comment">% Interpolation</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,291" id="srcline291">291</a></span><span class="line">        <span class="mxinfo" id="T1:U1744"><span class="var type1" id="S2T1U2590">CN</span> = <span class="mxinfo" id="T1:U1746">interp1(<span class="mxinfo" id="T23:U1747">[<span class="var type1" id="S33T1U2595">LowAlpEnd_P</span>,<span class="var type1" id="S37T1U2596">HighAlpStart_P</span>]</span>,<span class="mxinfo" id="T23:U1750">[<span class="var type1" id="S74T1U2599">CN1</span>,<span class="var type1" id="S78T1U2600">CN2</span>]</span>,<span class="var type1" id="S8T1U2601">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,292" id="srcline292">292</a></span><span class="line">        <span class="mxinfo" id="T1:U1754"><span class="var type1" id="S3T1U2604">CL</span> = <span class="mxinfo" id="T1:U1756">interp1(<span class="mxinfo" id="T23:U1757">[<span class="var type1" id="S33T1U2609">LowAlpEnd_P</span>,<span class="var type1" id="S37T1U2610">HighAlpStart_P</span>]</span>,<span class="mxinfo" id="T23:U1760">[<span class="var type1" id="S72T1U2613">CL1</span>,<span class="var type1" id="S81T1U2614">CL2</span>]</span>,<span class="var type1" id="S8T1U2615">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,293" id="srcline293">293</a></span><span class="line">        <span class="mxinfo" id="T1:U1764"><span class="var type1" id="S4T1U2618">CD</span> = <span class="mxinfo" id="T1:U1766">interp1(<span class="mxinfo" id="T23:U1767">[<span class="var type1" id="S33T1U2623">LowAlpEnd_P</span>,<span class="var type1" id="S37T1U2624">HighAlpStart_P</span>]</span>,<span class="mxinfo" id="T23:U1770">[<span class="var type1" id="S73T1U2627">CD1</span>,<span class="var type1" id="S82T1U2628">CD2</span>]</span>,<span class="var type1" id="S8T1U2629">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,294" id="srcline294">294</a></span><span class="line">        <span class="mxinfo" id="T1:U1774"><span class="var type1" id="S5T1U2632">CM</span> = <span class="mxinfo" id="T1:U1776">interp1(<span class="mxinfo" id="T23:U1777">[<span class="var type1" id="S33T1U2637">LowAlpEnd_P</span>,<span class="var type1" id="S37T1U2638">HighAlpStart_P</span>]</span>,<span class="mxinfo" id="T23:U1780">[<span class="var type1" id="S75T1U2641">CM1</span>,<span class="var type1" id="S83T1U2642">CM2</span>]</span>,<span class="var type1" id="S8T1U2643">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,295" id="srcline295">295</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,296" id="srcline296">296</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,297" id="srcline297">297</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1784"><span class="var type1" id="S8T1U2647">alp</span> &gt;= <span class="var type1" id="S37T1U2648">HighAlpStart_P</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1787"><span class="var type1" id="S8T1U2650">alp</span> &lt;= <span class="var type1" id="S38T1U2651">HighAlpEnd_P</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,298" id="srcline298">298</a></span><span class="line">        <span class="mxinfo" id="T1:U1790"><span class="var type1" id="S6T1U2654">Reg</span> = <span class="mxinfo" id="T1:U1792">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,299" id="srcline299">299</a></span><span class="line">        <span class="comment">% Equivalent flat plate</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,300" id="srcline300">300</a></span><span class="line">        <span class="mxinfo" id="T1:U1793"><span class="var type1" id="S55T1U2658">a_eff</span> = <span class="mxinfo" id="T1:U1795"><span class="var type1" id="S8T1U2660">alp</span> + <span class="var type1" id="S42T1U2661">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,301" id="srcline301">301</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,302" id="srcline302">302</a></span><span class="line">        <span class="comment">% Determining effective Cd90</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,303" id="srcline303">303</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U1798"><span class="mxinfo" id="T1:U1799"><span class="var type1" id="S9T1U2667">cf</span>/<span class="var type1" id="S10T1U2668">c</span></span> == <span class="mxinfo" id="T1:U1802">1</span></span> || <span class="mxinfo" id="T4:U1803"><span class="mxinfo" id="T1:U1804"><span class="var type1" id="S9T1U2672">cf</span>/<span class="var type1" id="S10T1U2673">c</span></span> == <span class="mxinfo" id="T1:U1807">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,304" id="srcline304">304</a></span><span class="line">            <span class="mxinfo" id="T1:U1808"><span class="var type1" id="S76T1U2677">Cd90_eff</span> = <span class="var type1" id="S14T1U2678">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,305" id="srcline305">305</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1811"><span class="mxinfo" id="T1:U1812">sign(<span class="var type1" id="S8T1U2683">alp</span>)</span> == <span class="mxinfo" id="T1:U1814">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,306" id="srcline306">306</a></span><span class="line">            <span class="mxinfo" id="T1:U1815"><span class="var type1" id="S76T1U2687">Cd90_eff</span> = <span class="mxinfo" id="T1:U1817"><span class="mxinfo" id="T1:U1818"><span class="mxinfo" id="T1:U1819"><span class="mxinfo" id="T1:U1820">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1821">(<span class="mxinfo" id="T1:U1822"><span class="mxinfo" id="T1:U1823"><span class="var type1" id="S11T1U2697">def</span>*<span class="mxinfo" id="T1:U1825">180</span></span>/<span class="mxinfo" id="T1:U1826">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U1827"><span class="mxinfo" id="T1:U1828">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1829"><span class="mxinfo" id="T1:U1830"><span class="var type1" id="S11T1U2707">def</span>*<span class="mxinfo" id="T1:U1832">180</span></span>/<span class="mxinfo" id="T1:U1833">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U2711">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,307" id="srcline307">307</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,308" id="srcline308">308</a></span><span class="line">            <span class="mxinfo" id="T1:U1835"><span class="var type1" id="S76T1U2715">Cd90_eff</span> = <span class="mxinfo" id="T1:U1837"><span class="mxinfo" id="T1:U1838"><span class="mxinfo" id="T1:U1839"><span class="mxinfo" id="T1:U1840">-1.29630E-05</span>*<span class="mxinfo" id="T1:U1841">(<span class="mxinfo" id="T1:U1842"><span class="mxinfo" id="T1:U1843"><span class="var type1" id="S11T1U2725">def</span>*<span class="mxinfo" id="T1:U1845">180</span></span>/<span class="mxinfo" id="T1:U1846">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U1847"><span class="mxinfo" id="T1:U1848">3.61111E-03</span>*(<span class="mxinfo" id="T1:U1849"><span class="mxinfo" id="T1:U1850"><span class="var type1" id="S11T1U2735">def</span>*<span class="mxinfo" id="T1:U1852">180</span></span>/<span class="mxinfo" id="T1:U1853">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U2739">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,309" id="srcline309">309</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,310" id="srcline310">310</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,311" id="srcline311">311</a></span><span class="line">        <span class="comment">% Hoerner Model</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,312" id="srcline312">312</a></span><span class="line">        <span class="mxinfo" id="T1:U1855"><span class="var type1" id="S2T1U2742">CN</span> = <span class="mxinfo" id="T1:U1857"><span class="mxinfo" id="T1:U1858"><span class="mxinfo" id="T1:U1859"><span class="mxinfo" id="T1:U1860"><span class="var type1" id="S16T1U2746">k_CN</span></span>*<span class="var type1" id="S76T1U2747">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U1863"><span class="mxinfo" id="T1:U1864"><span class="mxinfo" id="T1:U1865">1</span>/(<span class="mxinfo" id="T1:U1866"><span class="mxinfo" id="T1:U1867">0.56</span> + <span class="mxinfo" id="T1:U1868"><span class="mxinfo" id="T1:U1869">0.44</span>*<span class="mxinfo" id="T1:U1870">sin(<span class="mxinfo" id="T1:U1871">abs(<span class="var type1" id="S55T1U2761">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U1873"><span class="mxinfo" id="T1:U1874">0.41</span>*(<span class="mxinfo" id="T1:U1875"><span class="mxinfo" id="T1:U1876">1</span>-<span class="mxinfo" id="T1:U1877">exp(<span class="mxinfo" id="T1:U1878"><span class="mxinfo" id="T1:U1879">-17</span>/<span class="var type1" id="S12T1U2772">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U1881">sin(<span class="mxinfo" id="T1:U1882">abs(<span class="var type1" id="S55T1U2777">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,313" id="srcline313">313</a></span><span class="line">        <span class="mxinfo" id="T1:U1884"><span class="var type1" id="S84T1U2780">CT</span> = <span class="mxinfo" id="T1:U1886"><span class="mxinfo" id="T1:U1887"><span class="mxinfo" id="T1:U1888">0.5</span>*<span class="var type1" id="S13T1U2784">Cd0</span></span>*<span class="mxinfo" id="T1:U1890">cos(<span class="var type1" id="S55T1U2787">a_eff</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,314" id="srcline314">314</a></span><span class="line">        <span class="mxinfo" id="T1:U1892"><span class="var type1" id="S3T1U2790">CL</span> = <span class="mxinfo" id="T1:U1894"><span class="mxinfo" id="T1:U1895"><span class="var type1" id="S2T1U2793">CN</span>*<span class="mxinfo" id="T1:U1897">cos(<span class="var type1" id="S55T1U2796">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U1899"><span class="var type1" id="S84T1U2798">CT</span>*<span class="mxinfo" id="T1:U1901">sin(<span class="var type1" id="S55T1U2801">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,315" id="srcline315">315</a></span><span class="line">        <span class="mxinfo" id="T1:U1903"><span class="var type1" id="S4T1U2804">CD</span> = <span class="mxinfo" id="T1:U1905"><span class="mxinfo" id="T1:U1906"><span class="var type1" id="S2T1U2807">CN</span>*<span class="mxinfo" id="T1:U1908">sin(<span class="var type1" id="S55T1U2810">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1910"><span class="var type1" id="S84T1U2812">CT</span>*<span class="mxinfo" id="T1:U1912">cos(<span class="var type1" id="S55T1U2815">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,316" id="srcline316">316</a></span><span class="line">        <span class="mxinfo" id="T1:U1914"><span class="var type1" id="S5T1U2818">CM</span> = <span class="mxinfo" id="T1:U1916"><span class="mxinfo" id="T1:U1917">-(<span class="mxinfo" id="T1:U1918"><span class="mxinfo" id="T1:U1919">0.25</span>-<span class="mxinfo" id="T1:U1920"><span class="mxinfo" id="T1:U1921">0.175</span>*(<span class="mxinfo" id="T1:U1922"><span class="mxinfo" id="T1:U1923">1</span>-<span class="mxinfo" id="T1:U1924"><span class="mxinfo" id="T1:U1925">abs(<span class="var type1" id="S55T1U2832">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U1927">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S2T1U2838">CN</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,317" id="srcline317">317</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,318" id="srcline318">318</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,319" id="srcline319">319</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U1929"><span class="var type1" id="S8T1U2842">alp</span> &gt; <span class="var type1" id="S38T1U2843">HighAlpEnd_P</span></span> &amp;&amp; <span class="mxinfo" id="T4:U1932"><span class="var type1" id="S8T1U2845">alp</span> &lt; <span class="var type1" id="S35T1U2846">LowAlpStart_P</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,320" id="srcline320">320</a></span><span class="line">        <span class="mxinfo" id="T1:U1935"><span class="var type1" id="S6T1U2849">Reg</span> = <span class="mxinfo" id="T1:U1937">-<span class="mxinfo" id="T1:U1938">3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,321" id="srcline321">321</a></span><span class="line">        <span class="comment">% Linear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,322" id="srcline322">322</a></span><span class="line">        <span class="mxinfo" id="T1:U1939"><span class="var type1" id="S55T1U2854">a_eff</span> = <span class="mxinfo" id="T1:U1941"><span class="mxinfo" id="T1:U1942"><span class="var type1" id="S35T1U2857">LowAlpStart_P</span> - <span class="var type1" id="S32T1U2858">alp0_eff</span></span> - <span class="mxinfo" id="T1:U1945">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,323" id="srcline323">323</a></span><span class="line">        <span class="mxinfo" id="T1:U1946"><span class="var type1" id="S72T1U2863">CL1</span> = <span class="mxinfo" id="T1:U1948"><span class="mxinfo" id="T1:U1949"><span class="mxinfo" id="T1:U1950"><span class="var type1" id="S30T1U2867">Kp</span>*<span class="mxinfo" id="T1:U1952">sin(<span class="var type1" id="S55T1U2870">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1954">(<span class="mxinfo" id="T1:U1955">cos(<span class="var type1" id="S55T1U2875">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U1957"><span class="mxinfo" id="T1:U1958"><span class="mxinfo" id="T1:U1959"><span class="mxinfo" id="T1:U1960"><span class="var type1" id="S31T1U2880">Kv</span></span>*<span class="mxinfo" id="T1:U1962">abs(<span class="mxinfo" id="T1:U1963">sin(<span class="var type1" id="S55T1U2885">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1965">sin(<span class="var type1" id="S55T1U2888">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1967">cos(<span class="var type1" id="S55T1U2891">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,324" id="srcline324">324</a></span><span class="line">        <span class="mxinfo" id="T1:U1969"><span class="var type1" id="S73T1U2894">CD1</span> = <span class="mxinfo" id="T1:U1971"><span class="var type1" id="S13T1U2896">Cd0</span> + <span class="mxinfo" id="T1:U1973">abs(<span class="mxinfo" id="T1:U1974"><span class="mxinfo" id="T1:U1975"><span class="mxinfo" id="T1:U1976"><span class="mxinfo" id="T1:U1977"><span class="var type1" id="S30T1U2903">Kp</span>*<span class="mxinfo" id="T1:U1979">abs(<span class="mxinfo" id="T1:U1980">sin(<span class="var type1" id="S55T1U2908">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U1982">sin(<span class="var type1" id="S55T1U2911">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U1984">cos(<span class="var type1" id="S55T1U2914">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U1986"><span class="mxinfo" id="T1:U1987"><span class="var type1" id="S31T1U2916">Kv</span></span>*<span class="mxinfo" id="T1:U1989">(<span class="mxinfo" id="T1:U1990">sin(<span class="var type1" id="S55T1U2921">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,325" id="srcline325">325</a></span><span class="line">        <span class="mxinfo" id="T1:U1992"><span class="var type1" id="S74T1U2925">CN1</span> = <span class="mxinfo" id="T1:U1994">-(<span class="mxinfo" id="T1:U1995"><span class="mxinfo" id="T1:U1996"><span class="mxinfo" id="T1:U1997"><span class="var type1" id="S30T1U2931">Kp</span>*<span class="mxinfo" id="T1:U1999">sin(<span class="var type1" id="S55T1U2934">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U2001">cos(<span class="var type1" id="S55T1U2937">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U2003"><span class="mxinfo" id="T1:U2004"><span class="mxinfo" id="T1:U2005"><span class="var type1" id="S31T1U2940">Kv</span></span>*<span class="mxinfo" id="T1:U2007">abs(<span class="mxinfo" id="T1:U2008">sin(<span class="var type1" id="S55T1U2945">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U2010">sin(<span class="var type1" id="S55T1U2948">a_eff</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,326" id="srcline326">326</a></span><span class="line">        <span class="mxinfo" id="T1:U2012"><span class="var type1" id="S75T1U2951">CM1</span> = <span class="mxinfo" id="T1:U2014"><span class="mxinfo" id="T1:U2015">-(<span class="mxinfo" id="T1:U2016"><span class="mxinfo" id="T1:U2017">0.25</span>-<span class="mxinfo" id="T1:U2018"><span class="mxinfo" id="T1:U2019">0.175</span>*(<span class="mxinfo" id="T1:U2020"><span class="mxinfo" id="T1:U2021">1</span>-<span class="mxinfo" id="T1:U2022"><span class="mxinfo" id="T1:U2023">abs(<span class="mxinfo" id="T1:U2024"><span class="var type1" id="S55T1U2966">a_eff</span>-<span class="mxinfo" id="T1:U2026">pi</span></span>)</span>/(<span class="mxinfo" id="T1:U2027">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S74T1U2974">CN1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,327" id="srcline327">327</a></span><span class="line">        <span class="comment">%CM1 = (0.42-0.25)*Kv*abs(sin(a_eff))*sin(a_eff);          </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,328" id="srcline328">328</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,329" id="srcline329">329</a></span><span class="line">        <span class="comment">% NonLinear End</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,330" id="srcline330">330</a></span><span class="line">        <span class="mxinfo" id="T1:U2029"><span class="var type1" id="S55T1U2977">a_eff</span> = <span class="mxinfo" id="T1:U2031"><span class="var type1" id="S38T1U2979">HighAlpEnd_P</span> + <span class="var type1" id="S42T1U2980">gamma</span></span></span>; <span class="comment">%- alp0_eff;</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,331" id="srcline331">331</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,332" id="srcline332">332</a></span><span class="line">        <span class="comment">% Determining effective Cd90</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,333" id="srcline333">333</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T4:U2034"><span class="mxinfo" id="T1:U2035"><span class="var type1" id="S9T1U2986">cf</span>/<span class="var type1" id="S10T1U2987">c</span></span> == <span class="mxinfo" id="T1:U2038">1</span></span> || <span class="mxinfo" id="T4:U2039"><span class="mxinfo" id="T1:U2040"><span class="var type1" id="S9T1U2991">cf</span>/<span class="var type1" id="S10T1U2992">c</span></span> == <span class="mxinfo" id="T1:U2043">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,334" id="srcline334">334</a></span><span class="line">            <span class="mxinfo" id="T1:U2044"><span class="var type1" id="S76T1U2996">Cd90_eff</span> = <span class="var type1" id="S14T1U2997">Cd90</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,335" id="srcline335">335</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T4:U2047"><span class="mxinfo" id="T1:U2048">sign(<span class="var type1" id="S38T1U3002">HighAlpEnd_P</span>)</span> == <span class="mxinfo" id="T1:U2050">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="100,336" id="srcline336">336</a></span><span class="line">            <span class="mxinfo" id="T1:U2051"><span class="var type1" id="S76T1U3006">Cd90_eff</span> = <span class="mxinfo" id="T1:U2053"><span class="mxinfo" id="T1:U2054"><span class="mxinfo" id="T1:U2055"><span class="mxinfo" id="T1:U2056">-1.29630E-05</span>*<span class="mxinfo" id="T1:U2057">(<span class="mxinfo" id="T1:U2058"><span class="mxinfo" id="T1:U2059"><span class="var type1" id="S11T1U3016">def</span>*<span class="mxinfo" id="T1:U2061">180</span></span>/<span class="mxinfo" id="T1:U2062">pi</span></span>)^2</span></span> + <span class="mxinfo" id="T1:U2063"><span class="mxinfo" id="T1:U2064">3.61111E-03</span>*(<span class="mxinfo" id="T1:U2065"><span class="mxinfo" id="T1:U2066"><span class="var type1" id="S11T1U3026">def</span>*<span class="mxinfo" id="T1:U2068">180</span></span>/<span class="mxinfo" id="T1:U2069">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U3030">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,337" id="srcline337">337</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,338" id="srcline338">338</a></span><span class="line">            <span class="mxinfo" id="T1:U2071"><span class="var type1" id="S76T1U3034">Cd90_eff</span> = <span class="mxinfo" id="T1:U2073"><span class="mxinfo" id="T1:U2074"><span class="mxinfo" id="T1:U2075"><span class="mxinfo" id="T1:U2076">-1.29630E-05</span>*<span class="mxinfo" id="T1:U2077">(<span class="mxinfo" id="T1:U2078"><span class="mxinfo" id="T1:U2079"><span class="var type1" id="S11T1U3044">def</span>*<span class="mxinfo" id="T1:U2081">180</span></span>/<span class="mxinfo" id="T1:U2082">pi</span></span>)^2</span></span> - <span class="mxinfo" id="T1:U2083"><span class="mxinfo" id="T1:U2084">3.61111E-03</span>*(<span class="mxinfo" id="T1:U2085"><span class="mxinfo" id="T1:U2086"><span class="var type1" id="S11T1U3054">def</span>*<span class="mxinfo" id="T1:U2088">180</span></span>/<span class="mxinfo" id="T1:U2089">pi</span></span>)</span></span> + <span class="var type1" id="S14T1U3058">Cd90</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,339" id="srcline339">339</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,340" id="srcline340">340</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,341" id="srcline341">341</a></span><span class="line">        <span class="comment">% Hoerner Model        </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,342" id="srcline342">342</a></span><span class="line">        <span class="mxinfo" id="T1:U2091"><span class="var type1" id="S78T1U3061">CN2</span> = <span class="mxinfo" id="T1:U2093"><span class="mxinfo" id="T1:U2094"><span class="mxinfo" id="T1:U2095"><span class="mxinfo" id="T1:U2096"><span class="var type1" id="S16T1U3065">k_CN</span></span>*<span class="var type1" id="S76T1U3066">Cd90_eff</span></span>*(<span class="mxinfo" id="T1:U2099"><span class="mxinfo" id="T1:U2100"><span class="mxinfo" id="T1:U2101">1</span>/(<span class="mxinfo" id="T1:U2102"><span class="mxinfo" id="T1:U2103">0.56</span> + <span class="mxinfo" id="T1:U2104"><span class="mxinfo" id="T1:U2105">0.44</span>*<span class="mxinfo" id="T1:U2106">sin(<span class="mxinfo" id="T1:U2107">abs(<span class="var type1" id="S55T1U3080">a_eff</span>)</span>)</span></span></span>)</span> - <span class="mxinfo" id="T1:U2109"><span class="mxinfo" id="T1:U2110">0.41</span>*(<span class="mxinfo" id="T1:U2111"><span class="mxinfo" id="T1:U2112">1</span>-<span class="mxinfo" id="T1:U2113">exp(<span class="mxinfo" id="T1:U2114"><span class="mxinfo" id="T1:U2115">-17</span>/<span class="var type1" id="S12T1U3091">AR</span></span>)</span></span>)</span></span>)</span>*<span class="mxinfo" id="T1:U2117">sin(<span class="mxinfo" id="T1:U2118">abs(<span class="var type1" id="S55T1U3096">a_eff</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,343" id="srcline343">343</a></span><span class="line">        <span class="mxinfo" id="T1:U2120"><span class="var type1" id="S84T1U3099">CT</span> = <span class="mxinfo" id="T1:U2122"><span class="mxinfo" id="T1:U2123"><span class="mxinfo" id="T1:U2124">0.5</span>*<span class="var type1" id="S13T1U3103">Cd0</span></span>*<span class="mxinfo" id="T1:U2126">cos(<span class="var type1" id="S55T1U3106">a_eff</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,344" id="srcline344">344</a></span><span class="line">        <span class="mxinfo" id="T1:U2128"><span class="var type1" id="S81T1U3109">CL2</span> = <span class="mxinfo" id="T1:U2130"><span class="mxinfo" id="T1:U2131"><span class="var type1" id="S78T1U3112">CN2</span>*<span class="mxinfo" id="T1:U2133">cos(<span class="var type1" id="S55T1U3115">a_eff</span>)</span></span> - <span class="mxinfo" id="T1:U2135"><span class="var type1" id="S84T1U3117">CT</span>*<span class="mxinfo" id="T1:U2137">sin(<span class="var type1" id="S55T1U3120">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,345" id="srcline345">345</a></span><span class="line">        <span class="mxinfo" id="T1:U2139"><span class="var type1" id="S82T1U3123">CD2</span> = <span class="mxinfo" id="T1:U2141"><span class="mxinfo" id="T1:U2142"><span class="var type1" id="S78T1U3126">CN2</span>*<span class="mxinfo" id="T1:U2144">sin(<span class="var type1" id="S55T1U3129">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U2146"><span class="var type1" id="S84T1U3131">CT</span>*<span class="mxinfo" id="T1:U2148">cos(<span class="var type1" id="S55T1U3134">a_eff</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,346" id="srcline346">346</a></span><span class="line">        <span class="mxinfo" id="T1:U2150"><span class="var type1" id="S83T1U3137">CM2</span> = <span class="mxinfo" id="T1:U2152"><span class="mxinfo" id="T1:U2153">-(<span class="mxinfo" id="T1:U2154"><span class="mxinfo" id="T1:U2155">0.25</span>-<span class="mxinfo" id="T1:U2156"><span class="mxinfo" id="T1:U2157">0.175</span>*(<span class="mxinfo" id="T1:U2158"><span class="mxinfo" id="T1:U2159">1</span>-<span class="mxinfo" id="T1:U2160"><span class="mxinfo" id="T1:U2161">abs(<span class="var type1" id="S55T1U3151">a_eff</span>)</span>/(<span class="mxinfo" id="T1:U2163">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S78T1U3157">CN2</span></span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="100,347" id="srcline347">347</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="100,348" id="srcline348">348</a></span><span class="line">        <span class="comment">% Interpolation</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,349" id="srcline349">349</a></span><span class="line">        <span class="mxinfo" id="T1:U2165"><span class="var type1" id="S2T1U3160">CN</span> = <span class="mxinfo" id="T1:U2167">interp1(<span class="mxinfo" id="T23:U2168">[<span class="var type1" id="S35T1U3165">LowAlpStart_P</span>,<span class="var type1" id="S38T1U3166">HighAlpEnd_P</span>]</span>,<span class="mxinfo" id="T23:U2171">[<span class="var type1" id="S74T1U3169">CN1</span>,<span class="var type1" id="S78T1U3170">CN2</span>]</span>,<span class="var type1" id="S8T1U3171">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,350" id="srcline350">350</a></span><span class="line">        <span class="mxinfo" id="T1:U2175"><span class="var type1" id="S3T1U3174">CL</span> = <span class="mxinfo" id="T1:U2177">interp1(<span class="mxinfo" id="T23:U2178">[<span class="var type1" id="S35T1U3179">LowAlpStart_P</span>,<span class="var type1" id="S38T1U3180">HighAlpEnd_P</span>]</span>,<span class="mxinfo" id="T23:U2181">[<span class="var type1" id="S72T1U3183">CL1</span>,<span class="var type1" id="S81T1U3184">CL2</span>]</span>,<span class="var type1" id="S8T1U3185">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,351" id="srcline351">351</a></span><span class="line">        <span class="mxinfo" id="T1:U2185"><span class="var type1" id="S4T1U3188">CD</span> = <span class="mxinfo" id="T1:U2187">interp1(<span class="mxinfo" id="T23:U2188">[<span class="var type1" id="S35T1U3193">LowAlpStart_P</span>,<span class="var type1" id="S38T1U3194">HighAlpEnd_P</span>]</span>,<span class="mxinfo" id="T23:U2191">[<span class="var type1" id="S73T1U3197">CD1</span>,<span class="var type1" id="S82T1U3198">CD2</span>]</span>,<span class="var type1" id="S8T1U3199">alp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,352" id="srcline352">352</a></span><span class="line">        <span class="mxinfo" id="T1:U2195"><span class="var type1" id="S5T1U3202">CM</span> = <span class="mxinfo" id="T1:U2197">interp1(<span class="mxinfo" id="T23:U2198">[<span class="var type1" id="S35T1U3207">LowAlpStart_P</span>,<span class="var type1" id="S38T1U3208">HighAlpEnd_P</span>]</span>,<span class="mxinfo" id="T23:U2201">[<span class="var type1" id="S75T1U3211">CM1</span>,<span class="var type1" id="S83T1U3212">CM2</span>]</span>,<span class="var type1" id="S8T1U3213">alp</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="100,353" id="srcline353">353</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="100,354" id="srcline354">354</a></span><span class="line">    <span class="comment">% ------------------------------------------------- %</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,355" id="srcline355">355</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="100,356" id="srcline356">356</a></span><span class="line">        <span class="mxinfo" id="T1:U2205"><span class="var type1" id="S6T1U3217">Reg</span> = <span class="mxinfo" id="T1:U2207">4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,357" id="srcline357">357</a></span><span class="line">        <span class="mxinfo" id="T1:U2208"><span class="var type1" id="S55T1U3221">a_eff</span> = <span class="mxinfo" id="T1:U2210"><span class="mxinfo" id="T1:U2211"><span class="var type1" id="S8T1U3224">alp</span> - <span class="var type1" id="S32T1U3225">alp0_eff</span></span> - <span class="mxinfo" id="T1:U2214">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,358" id="srcline358">358</a></span><span class="line">        <span class="mxinfo" id="T1:U2215"><span class="var type1" id="S3T1U3230">CL</span> = <span class="mxinfo" id="T1:U2217"><span class="mxinfo" id="T1:U2218"><span class="mxinfo" id="T1:U2219"><span class="var type1" id="S30T1U3234">Kp</span>*<span class="mxinfo" id="T1:U2221">sin(<span class="var type1" id="S55T1U3237">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U2223">(<span class="mxinfo" id="T1:U2224">cos(<span class="var type1" id="S55T1U3242">a_eff</span>)</span>)^2</span></span> + <span class="mxinfo" id="T1:U2226"><span class="mxinfo" id="T1:U2227"><span class="mxinfo" id="T1:U2228"><span class="mxinfo" id="T1:U2229"><span class="var type1" id="S31T1U3247">Kv</span></span>*<span class="mxinfo" id="T1:U2231">abs(<span class="mxinfo" id="T1:U2232">sin(<span class="var type1" id="S55T1U3252">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U2234">sin(<span class="var type1" id="S55T1U3255">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U2236">cos(<span class="var type1" id="S55T1U3258">a_eff</span>)</span></span></span></span>;        </span></span>
<span class="srcline"><span class="lineno"><a href="100,359" id="srcline359">359</a></span><span class="line">        <span class="mxinfo" id="T1:U2238"><span class="var type1" id="S4T1U3261">CD</span> = <span class="mxinfo" id="T1:U2240"><span class="var type1" id="S13T1U3263">Cd0</span> + <span class="mxinfo" id="T1:U2242">abs(<span class="mxinfo" id="T1:U2243"><span class="mxinfo" id="T1:U2244"><span class="mxinfo" id="T1:U2245"><span class="mxinfo" id="T1:U2246"><span class="var type1" id="S30T1U3270">Kp</span>*<span class="mxinfo" id="T1:U2248">abs(<span class="mxinfo" id="T1:U2249">sin(<span class="var type1" id="S55T1U3275">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U2251">sin(<span class="var type1" id="S55T1U3278">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U2253">cos(<span class="var type1" id="S55T1U3281">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U2255"><span class="mxinfo" id="T1:U2256"><span class="var type1" id="S31T1U3283">Kv</span></span>*<span class="mxinfo" id="T1:U2258">(<span class="mxinfo" id="T1:U2259">sin(<span class="var type1" id="S55T1U3288">a_eff</span>)</span>)^3</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,360" id="srcline360">360</a></span><span class="line">        <span class="mxinfo" id="T1:U2261"><span class="var type1" id="S2T1U3292">CN</span> = <span class="mxinfo" id="T1:U2263">-(<span class="mxinfo" id="T1:U2264"><span class="mxinfo" id="T1:U2265"><span class="mxinfo" id="T1:U2266"><span class="var type1" id="S30T1U3298">Kp</span>*<span class="mxinfo" id="T1:U2268">sin(<span class="var type1" id="S55T1U3301">a_eff</span>)</span></span>*<span class="mxinfo" id="T1:U2270">cos(<span class="var type1" id="S55T1U3304">a_eff</span>)</span></span> + <span class="mxinfo" id="T1:U2272"><span class="mxinfo" id="T1:U2273"><span class="mxinfo" id="T1:U2274"><span class="var type1" id="S31T1U3307">Kv</span></span>*<span class="mxinfo" id="T1:U2276">abs(<span class="mxinfo" id="T1:U2277">sin(<span class="var type1" id="S55T1U3312">a_eff</span>)</span>)</span></span>*<span class="mxinfo" id="T1:U2279">sin(<span class="var type1" id="S55T1U3315">a_eff</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,361" id="srcline361">361</a></span><span class="line">        <span class="mxinfo" id="T1:U2281"><span class="var type1" id="S5T1U3318">CM</span> = <span class="mxinfo" id="T1:U2283"><span class="mxinfo" id="T1:U2284">-(<span class="mxinfo" id="T1:U2285"><span class="mxinfo" id="T1:U2286">0.25</span>-<span class="mxinfo" id="T1:U2287"><span class="mxinfo" id="T1:U2288">0.175</span>*(<span class="mxinfo" id="T1:U2289"><span class="mxinfo" id="T1:U2290">1</span>-<span class="mxinfo" id="T1:U2291"><span class="mxinfo" id="T1:U2292">abs(<span class="mxinfo" id="T1:U2293"><span class="var type1" id="S55T1U3333">a_eff</span>-<span class="mxinfo" id="T1:U2295">pi</span></span>)</span>/(<span class="mxinfo" id="T1:U2296">pi/2</span>)</span></span>)</span></span>)</span>*<span class="var type1" id="S2T1U3341">CN</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="100,362" id="srcline362">362</a></span><span class="line">        <span class="comment">%CM = (0.42-0.25)*Kv*abs(sin(a_eff))*sin(a_eff);    </span></span></span>
<span class="srcline"><span class="lineno"><a href="100,363" id="srcline363">363</a></span><span class="line">    <span class="keyword"><span class="keyword">end</span></span>     </span></span>
</pre>
